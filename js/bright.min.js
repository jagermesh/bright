/* jshint ignore:start */ /*! bright 15-06-2017 */
!function(a){a.br=a.br||{},a.br.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a.br.isNull=function(a){return void 0===a||null===a},a.br.isEmpty=function(a){return br.isNull(a)||br.isString(a)&&0===a.trim().length||"undefined"!=typeof a.length&&0===a.length},a.br.isArray=function(a){return!br.isNull(a)&&"[object Array]"===Object.prototype.toString.call(a)},a.br.isObject=function(a){return!br.isEmpty(a)&&"object"==typeof a},a.br.isEmptyObject=function(a){if(br.isObject(a)){var b=!0;for(var c in a){b=!1;break}return b}return!1},a.br.isBoolean=function(a){return"boolean"==typeof a},a.br.isString=function(a){return"string"==typeof a},a.br.isFunction=function(a){return"function"==typeof a},a.br.toString=function(a){return br.isNull(a)?"":a.toString()},a.br.split=function(a,b){return br.isEmpty(a)?[]:br.isString(a)?a.split(b):void 0},a.br.toInt=function(a){if(br.isString(a)){if(a.length>0)return parseInt(a,10)}else if(br.isNumber(a))return a},a.br.toReal=function(a){return br.isString(a)?a.length>0?parseFloat(a):0:br.isNumber(a)?a:0}}(window),function(a){function b(a){function b(a,b,c){var d=null,e=f.get(a,b);return br.isArray(e)&&e.length>0&&(d=e.pop(),c&&f.set(a,e)),br.isEmpty(d)?br.isNull(b)?d:b:d}function d(a,b,c){var d=null,e=f.get(a,b);return br.isArray(e)&&e.length>0&&(d=e.shift(),c&&f.set(a,e)),br.isEmpty(d)?br.isEmpty(b)?d:b:d}var e=a,f=this;this.get=function(a,b){var d;if(br.isArray(a)){d={};for(var f in a)d[a[f]]=this.get(a[f])}else d=c.unpack(e.getItem(a));return br.isEmpty(d)?br.isNull(b)?d:b:d},this.set=function(a,b){if(br.isObject(a))for(var d in a)this.set(d,a[d]);else e.setItem(a,c.pack(b));return this},this.inc=function(a,b,c){var d=this.get(a);return br.isNumber(d)?(b=br.isNumber(b)?b:1,this.set(a,d+b)):br.isString(d)?br.isEmpty(b)||(void 0===c&&(c=", "),d=br.isEmpty(d)?b:d+c+b,this.set(a,d)):(b=br.isNumber(b)?b:1,this.set(a,b)),this},this.dec=function(a,b){var c=this.get(a);return b=br.isNumber(b)?b:1,this.set(a,br.isNumber(c)?c-b:b),this},this.append=function(a,b,c){if(!br.isEmpty(b)){var d=this.get(a);if(br.isArray(d)||(d=[]),br.isArray(b))for(var e in b)this.append(a,b[e],c);else{if(br.isNumber(c))for(;d.length>=c;)d.shift();d.push(b),this.set(a,d)}}return this},this.appendUnique=function(a,b,c){return br.isEmpty(b)||(this.remove(a,b),this.append(a,b,c)),this},this.prepend=function(a,b,c){if(!br.isEmpty(b)){var d=this.get(a);if(br.isArray(d)||(d=[]),br.isArray(b))for(var e in b)this.prepend(a,b[e],c);else{if(br.isNumber(c))for(;d.length>=c;)d.pop();d.unshift(b),this.set(a,d)}}return this},this.prependUnique=function(a,b,c){return br.isEmpty(b)||(this.remove(a,b),this.prepend(a,b,c)),this},this.each=function(a,b){var c=this.get(a);br.isArray(c)||(c=[]);for(var d=0;d<c.length;d++)b.call(this,c[d]);return this},this.getLast=function(a,c){return b(a,c,!1)},this.takeLast=function(a,c){return b(a,c,!0)},this.getFirst=function(a,b){return d(a,b,!1)},this.takeFirst=function(a,b){return d(a,b,!0)},this.extend=function(a,b){if(!br.isEmpty(b)){var c=this.get(a);if(br.isObject(c)||(c={}),br.isObject(b)){for(var d in b)c[d]=b[d];this.set(a,c)}}return this},this.not=function(a){var b=this.get(a);return br.isBoolean(b)||(b=!1),this.set(a,!b),this},this.clear=function(){return e.clear(),this},this.all=function(){var a={};for(var b in e)a[b]=this.get(b);return a},this.remove=function(a,b){var c=this.get(a);if(!br.isEmpty(b)&&br.isArray(c)){var d=c.indexOf(b);d!=-1&&c.splice(d,1),this.set(a,c)}else e.removeItem(a);return this},this.indexOf=function(a,b){var c=this.get(a);return br.isArray(c)?c.indexOf(b):-1}}var c={pack:function(a){return JSON.stringify(a)},unpack:function(a){try{return JSON.parse(a)}catch(b){return null}}};a.br=a.br||{},a.br.storage=new b(a.localStorage),a.br.session=new b(a.sessionStorage)}(window),function(a){function b(a){function b(a,b,d){var e,f=null,g=c.subscribers[a];if(g)switch(b){case"before":for(e=0;e<g.before.length;e++)g.before[e].apply(c.obj,d);break;case"on":for(e=0;e<g.on.length;e++)f=g.on[e].apply(c.obj,d);break;case"after":for(e=0;e<g.after.length;e++)g.after[e].apply(c.obj,d)}return f}var c=this;this.subscribers={},this.connections=[],this.obj=a||this,this.before=function(a,b){a=a.split(",");for(var d=0;d<a.length;d++)c.subscribers[a[d]]=c.subscribers[a[d]]||{on:[],before:[],after:[]},c.subscribers[a[d]].before.push(b)},this.on=function(a,b){a=a.split(",");for(var d=0;d<a.length;d++)c.subscribers[a[d]]=c.subscribers[a[d]]||{on:[],before:[],after:[]},c.subscribers[a[d]].on.push(b)},this.after=function(a,b){a=a.split(",");for(var d=0;d<a.length;d++)c.subscribers[a[d]]=c.subscribers[a[d]]||{on:[],before:[],after:[]},c.subscribers[a[d]].after.push(b)},this.has=function(a){return c.subscribers.hasOwnProperty(a)},this.connectTo=function(a){c.connections.push(a)},this.triggerEx=function(a,d,e){var f,g=[];for(f=0;f<e.length;f++)g.push(e[f]);"*"!=a&&b("*",d,g),g.splice(0,1);var h=b(a,d,g);for(f=0;f<c.connections.length;f++)c.connections[f].triggerEx(a,d,e);return h},this.triggerBefore=function(a){return this.triggerEx(a,"before",arguments)},this.trigger=function(a){return this.triggerEx(a,"on",arguments)},this.triggerAfter=function(a){return this.triggerEx(a,"after",arguments)}}a.br=a.br||{},a.br.eventQueue=function(a){return new b(a)}}(window),function(a){function b(){this.continueRoute=!0,this.get=function(b,c){var d,e=document.location.search.replace("?","").split("&"),f={};for(d=0;d<e.length;d++){var g=e[d].split("=");if(g[0].indexOf("[")!=-1){var h=g[0].substr(0,g[0].indexOf("["));f[h]=f[h]||[],f[h].push(a.unescape(g[1]))}else f[g[0]]=a.unescape(g[1])}if(b){for(d in f)if(d==b)return f[d];return c}return f},this.hash=function(b,c){var d,e=document.location.hash.replace("#","").split("&"),f={};for(d=0;d<e.length;d++){var g=e[d].split("=");if(g[0].indexOf("[")!=-1){var h=g[0].substr(0,g[0].indexOf("["));f[h]=f[h]||[],f[h].push(a.unescape(g[1]))}else f[g[0]]=a.unescape(g[1])}if(b){for(d in f)if(d==b)return f[d];return c}return f},this.anchor=function(b){var c=document.location.hash.replace("#","");return c?(0===c.length&&(c=b),c=a.unescape(c)):c=b,c},this.route=function(a,b){if(this.continueRoute){var c=document.location.toString();c=c.replace(/[?].*/,""),c.search(a)!=-1&&(this.continueRoute=!1,b.call())}return this}}a.br=a.br||{},a.br.request=new b}(window),function(a){function b(a){var b=this;b.queue=[],b.workingQueue=[],b.lazy=a,this.push=function(a){b.queue.unshift({func:a}),b.lazy||b.wakeup()},this.done=function(a){b.workingQueue.pop(),b.wakeup()},this.clear=function(a){b.queue=[],b.workingQueue=[]},this.wakeup=function(){if(b.queue.length>0&&0===b.workingQueue.length){var a=b.queue.pop();b.workingQueue.push(a),a.func(function(){b.done()})}}}a.br=a.br||{},a.br.thread=function(a){return new b(a)};br.thread(!0)}(window),function(a){function b(){function a(){return this.start_time=0,this.stop_time=0,this.run_time=0,this.running=!1,this.start=function(){this.start_time=(new Date).getTime(),this.running=!0},this.stop=function(){this.stop_time=(new Date).getTime(),this.run_time=this.stop_time-this.start_time,this.running=!1},this.get_runtime=function(){return this.run_time},this.reset=function(){this.run_time=0},this}function b(a){return this.arr=new Int32Array(a),this.begin=0,this.end=-1,this.num_el=0,this.arr_size=a,this.push_back=function(a){this.num_el<this.arr_size?(this.end++,this.arr[this.end]=a,this.num_el++):(this.end=(this.end+1)%this.arr_size,this.begin=(this.begin+1)%this.arr_size,this.arr[this.end]=a)},this.get=function(a){return this.arr[(this.begin+a)%this.arr_size]},this.size=function(){return this.num_el},this}var c=0,d=new b(20);return this.fps=0,this.timers=[],this.frame_timer=new a,this.add=function(b){this.timers.push([b,new a])},this.new_frame=function(){++c;var a=0,b=0|this.timers.length;for(a=0;a<b;++a){var e=this.timers[a][1];e.reset()}if(c>=1){this.frame_timer.stop(),d.push_back(this.frame_timer.get_runtime());var f=d.size(),g=0;for(a=0;a<f;++a)g+=d.get(a);this.fps=f/g*1e3,this.frame_timer.start()}},this.find_task=function(a){var b=0|this.timers.length,c=0;for(c=0;c<b;++c){var d=this.timers[c];if(d[0]===a)return d}return this.add(a),this.find_task(a)},this.start=function(a){var b=this.find_task(a);b[1].start()},this.stop=function(a,b){var c=this.find_task(a);c[1].stop(),b&&br.log(c[0]+": "+c[1].get_runtime()+"ms")},this.log=function(a){var b=0|this.timers.length,c=0,d="<strong>FPS: "+this.fps.toFixed(2)+"</strong>",e="FPS: "+this.fps.toFixed(2);for(c=0;c<b;++c){var f=this.timers[c];d+="<br/>"+f[0]+": "+f[1].get_runtime()+"ms",e+=", "+f[0]+": "+f[1].get_runtime()+"ms"}return a&&br.log(e),d},this}a.br=a.br||{};var c;a.br.profiler=function(a){return a?new b:(c||(c=new b),c)}}(window),function(a,b){function c(){var a=[];return this.get=function(b){return a[b]?a[b]:b},this.set=function(b,c){return a[b]=c,this},this}function d(b){var c=br.inform("You browser is currently blocking popups",'<p>Click the link below to open this manually:</p><p><a target="_blank" class="action-open-link" href="'+b+'" style="word-wrap: break-word">'+b+"</a></p><p>To eliminate this extra step, we recommend you modify your settings to disable the popup blocker.</p>");a(".action-open-link",c).on("click",function(){c.modal("hide"),c.remove()})}function e(a,c){var d="BrModified_Callbacks2",e="BrModified_LastCahange2";if(c&&(b.clearTimeout(a.data("BrModified_Timeout")),d="BrModified_Callbacks1",e="BrModified_LastCahange1"),a.data(e)!=a.val()){a.data(e,a.val());var f=a.data(d);if(f)for(var g in f)f[g].call(a)}}function f(a){e(a,!1),a.data("BrModified_Callbacks1")&&(b.clearTimeout(a.data("BrModified_Timeout")),a.data("BrModified_Timeout",b.setTimeout(function(){e(a,!0)},1500)))}function g(b,c,d){a(b).each(function(){a(this).data("br-data-change-callbacks")||a(this).data("br-data-change-callbacks",[]);var b="BrModified_Callbacks2";d&&(b="BrModified_Callbacks1");var e=a(this).data(b);e||(e=[]),e.push(c),a(this).data(b,e)}),a(document).on("change",b,function(){f(a(this))}),a(document).on("keyup",b,function(b){13==b.keyCode?(e(a(this),!1),e(a(this),!0)):(8==b.keyCode||32==b.keyCode||91==b.keyCode||93==b.keyCode||b.keyCode>=48&&b.keyCode<=90||b.keyCode>=96&&b.keyCode<=111||b.keyCode>=186&&b.keyCode<=222)&&f(a(this))})}function h(){return m?br.closeConfirmationMessage:void(n=!0)}b.br=b.br||{};var i="",j=["vendor/jagermesh/bright/js/bright.min.js","vendor/jagermesh/bright/js/bright.js","bright/js/bright.min.js","bright/js/bright.js"];"undefined"==typeof b.br.frameworkUrl||j.push(b.br.frameworkUrl),a("script").each(function(){if(""===i){var b=a(this).attr("src");if(!br.isEmpty(b))for(var c in j){var d=b.indexOf(j[c]);d!=-1&&(i=b.substring(0,d))}}}),b.br.baseUrl=i,b.br.popupBlocker="unknown";var k=!1;b.br.log=function(a){if("undefined"!=typeof console){k||(console.log("*********************** LOG STARTED ***********************"),k=!0);for(var b in arguments)console.log(arguments[b])}},b.br.isTouchScreen=function(){var a=navigator.userAgent;return/iPad/i.test(a)||/iPhone/i.test(a)||/Android/i.test(a)},b.br.isMobileDevice=function(){var a=navigator.userAgent;return/iPad/i.test(a)||/iPhone/i.test(a)||/Android/i.test(a)},b.br.isiOS=function(){var a=navigator.userAgent;return/iPad/i.test(a)||/iPhone/i.test(a)},b.br.isiPad=function(){var a=navigator.userAgent;return/iPad/i.test(a)},b.br.isiPhone=function(){var a=navigator.userAgent;return/iPhone/i.test(a)},b.br.isAndroid=function(){var a=navigator.userAgent;return/android/i.test(a)},b.br.isIE=function(){return!!document.documentMode},b.br.isOpera=function(){return!!b.opera||navigator.userAgent.indexOf(" OPR/")>=0},b.br.isFirefox=function(){return"undefined"!=typeof InstallTrigger},b.br.isSafari=function(){return navigator.userAgent.indexOf("Safari")!=-1&&navigator.userAgent.indexOf("Chrome")==-1},b.br.isChrome=function(){return!!b.chrome&&!br.isOpera()},b.br.redirect=function(a){a.search(/^\//)==-1&&a.search(/^http[s]?:\/\//)==-1&&(a=this.baseUrl+a),document.location=a},b.br.refresh=function(){document.location.reload()},b.br.processArray=function(a,b,c,d){function e(b,c,d){if(a.length>0){var f=a.shift();b(f,function(){d.showProgress&&br.stepProgress(),e(b,c,d)})}else d.showProgress&&br.hideProgress(),c&&c()}d=d||{},a.length>0?(d.showProgress&&br.startProgress(a.length,d.title||""),e(b,c,d)):br.growlError("Please select at least one record")};var l=new c;b.br.trn=function(a){return a?l.get(a):l},b.br.preloadImages=function(a){try{var b=document.createElement("div"),c=b.style;c.position="absolute",c.top=c.left=0,c.visibility="hidden",document.body.appendChild(b),b.innerHTML='<img src="'+a.join('" /><img src="')+'" />'}catch(d){}},b.br.randomInt=function(a,b){return void 0===b&&(b=a,a=0),Math.floor(Math.random()*(b-a+1))+a},b.br.forHtml=function(a){return a&&(a=a.split("<").join("&lt;").split(">").join("&gt;")),a},b.br.extend=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype},b.br.openPage=function(a){if(br.isSafari())br.openPopup(a);else{var b=document.createElement("a");b.href=a,b.target="_blank",document.body.appendChild(b),b.click(),b.remove()}},b.br.openPopup=function(a,c){if("active"==b.br.popupBlocker)d(a);else{c=c||"_blank";var e,f;screen.width&&(e=screen.width>=1280?1e3:screen.width>=1024?800:600),screen.height&&(f=screen.height>=900?700:screen.height>=800?600:500);var g=screen.width?(screen.width-e)/2:0,h="height="+f+",width="+e+",top=20,left="+g+",menubar=0,scrollbars=1,resizable=1",i=b.open(a,c,h);i?(b.br.popupBlocker="inactive",i.focus()):(b.br.popupBlocker="active",d(a))}},b.br.modifiedDeferred=function(a,b){g(a,b,!0)},b.br.modified=function(a,b){g(a,b,!1)},b.br.onChange=function(b,c){a(b).on("change",function(){c.call(this)}),a(b).on("keyup",function(a){13==a.keyCode?c.call(this):(8==a.keyCode||32==a.keyCode||91==a.keyCode||93==a.keyCode||a.keyCode>=48&&a.keyCode<=90||a.keyCode>=96&&a.keyCode<=111||a.keyCode>=186&&a.keyCode<=222)&&c.call(this)})},b.br.closeConfirmationMessage="Some changes have been made. Are you sure you want to close current window?";var m=!1,n=!1;a(b).on("beforeunload",function(){return h()}),b.br.isUnloading=function(a){return"undefined"==typeof a?n:void(n=a)},b.br.isCloseConfirmationRequired=function(){return m},b.br.confirmClose=function(a){a&&(br.closeConfirmationMessage=a),m=!0,br.events.trigger("closeConfirmationRequested")},b.br.resetCloseConfirmation=function(a){m=!1,br.events.trigger("closeConfirmationReset")},b.br.events=br.eventQueue(),b.br.before=function(a,c){b.br.events.before(a,c)},b.br.on=function(a,c){b.br.events.on(a,c)},b.br.after=function(a,c){b.br.events.after(a,c)},b.br.backToCaller=function(a,c){var d=null!==b.opener;if(d){if(b.opener&&!b.opener.closed){b.opener.focus();try{c&&b.opener.document&&b.opener.document.location.reload()}catch(e){}}b.close()}else br.request.get("caller")?document.location=br.request.get("caller"):document.location=a},b.br.disableBounce=function(c){function d(){var c=a(b).height();e.css("height",c+"px"),e.css("overflow","auto")}var e=c;a("body").css("overflow","hidden"),d(),a(b).resize(function(){d()})},b.br.getSelection=function(){var a="";if("undefined"!=typeof b.getSelection){var c=b.getSelection();if(c.rangeCount){for(var d=document.createElement("div"),e=0,f=c.rangeCount;e<f;++e)d.appendChild(c.getRangeAt(e).cloneContents());a=d.innerHTML}}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(a=document.selection.createRange().htmlText);return a};var o;b.br.beep=function(a){try{var c=.1;b.AudioContext=b.AudioContext||b.webkitAudioContext,o||(o=new AudioContext);var d=o.createOscillator();d.type=0,d.connect(o.destination);var e=o.currentTime;d.start?(d.start(e),d.stop(e+c)):(d.noteOn(e),d.noteOff(e+c)),d.onended=function(){a&&a()}}catch(f){br.log(f)}},b.br["do"]=function(a){a.call()},b.br.load=b.br.resourceLoader=function(a){function b(b,c){var d,e=a.createElement(b);for(d in c)c.hasOwnProperty(d)&&e.setAttribute(d,c[d]);return e}function c(a){var b,c,d=i[a];d&&(b=d.callback,c=d.urls,c.shift(),j=0,c.length||(b&&b.call(d.context,d.obj),i[a]=null,k[a].length&&e(a)))}function d(){if(!g){var b=navigator.userAgent;g={async:a.createElement("script").async===!0},(g.webkit=/AppleWebKit\//.test(b))||(g.ie=/MSIE/.test(b))||(g.opera=/Opera/.test(b))||(g.gecko=/Gecko\//.test(b))||(g.unknown=!0)}}function e(e,j,l,m,n){var o,p,q,r,s=function(){c(e)},t="css"===e;if(d(),j)if(j="string"==typeof j?[j]:j.concat(),t||g.async||g.gecko||g.opera)k[e].push({urls:j,callback:l,obj:m,context:n});else for(o=0,p=j.length;o<p;++o)k[e].push({urls:[j[o]],callback:o===p-1?l:null,obj:m,context:n});if(!i[e]&&(r=i[e]=k[e].shift()))for(h||(h=a.head||a.getElementsByTagName("head")[0]),j=r.urls,o=0,p=j.length;o<p;++o)l=j[o],t?q=g.gecko?b("style"):b("link",{href:l,rel:"stylesheet"}):(q=b("script",{src:l}),q.async=!1),q.className="lazyload",q.setAttribute("charset","utf-8"),g.ie&&!t?q.onreadystatechange=function(){/loaded|complete/.test(q.readyState)&&(q.onreadystatechange=null,s())}:t&&(g.gecko||g.webkit)?g.webkit?(r.urls[o]=q.href,f()):(q.innerHTML='@import "'+l+'";',c("css")):q.onload=q.onerror=s,h.appendChild(q)}function f(){var a,b=i.css;if(b){for(a=l.length;--a>=0;)if(l[a].href===b.urls[0]){c("css");break}j+=1,b&&(j<200?setTimeout(f,50):c("css"))}}var g,h,i={},j=0,k={css:[],js:[]},l=a.styleSheets;return{css:function(a,b,c,d){e("css",a,b,c,d)},js:function(a,b,c,d){e("js",a,b,c,d)}}}(document),b.br.URL=b.URL||b.webkitURL;var p=0,q=!0;b.br.requestAnimationFrame=function(a,c){var d=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.oRequestAnimationFrame||b.msRequestAnimationFrame||function(a,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-p)),f=b.setTimeout(function(){a(d+e)},e);return p=d+e,f};return d.call(b,a,c)},b.br.cancelAnimationFrame=function(a){var c=b.cancelAnimationFrame||function(a){b.clearTimeout(a)};return c.call(b,a)},b.br.getUserMedia=function(a,c,d){var e=b.navigator.getUserMedia||b.navigator.mozGetUserMedia||b.navigator.webkitGetUserMedia||b.navigator.msGetUserMedia||function(a,b,c){c()};return e.call(b.navigator,a,c,d)},b.br.detectEndian=function(){var a=new ArrayBuffer(8),b=new Uint32Array(a);return b[0]=4278190080,q=!0,255===a[0]&&(q=!1),q}}(jQuery,window),function(a){function b(a,b){var c=[];this.append=function(d){a?br.storage.appendUnique(b,d):this.isFlagged(d)||c.push(d)},this.isFlagged=function(d){return a?br.storage.indexOf(b,d)!=-1:c.indexOf(d)!=-1},this.remove=function(d){if(a)br.storage.remove(b,d);else{var e=c.indexOf(d);e!=-1&&c.splice(e,1)}},this.clear=function(){this.replace([])},this.replace=function(d){return a?br.storage.set(b,d):c=d},this.get=function(){return a?br.storage.get(b,[]):c}}a.br=a.br||{},a.br.flagsHolder=function(a,c){return new b(a,c)}}(window),function(a,b){function c(c,d){function e(a,b,c,d){d=d||{};var e=d&&d.disableEvents;d&&d.selectOne;e||(g.events.trigger("error","select",a),g.events.triggerAfter("select",!1,a,b)),"function"==typeof c&&c.call(g,!1,a,b)}function f(a,b,c,d){d=d||{};var f=d&&d.disableEvents,h=d&&d.selectCount,i=d&&(d.selectOne||d.selectCount);if(i&&br.isArray(a)){if(!(a.length>0))return void e("Record not found",b,c,d);a=a[0]}else i||br.isArray(a)||(a=[a]);h&&(a=parseInt(a)),f||(g.events.trigger("select",a),g.events.triggerAfter("select",!0,a,b)),"function"==typeof c&&c.call(g,!0,a,b)}var g=this;this.ajaxRequest=null,this.name="-",this.options=d||{},this.options.restServiceUrl=c,this.options.refreshDelay=this.options.refreshDelay||1500,"/"!=this.options.restServiceUrl.charAt(this.options.restServiceUrl.length-1)&&(this.options.restServiceUrl=this.options.restServiceUrl+"/"),this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)};var h=0;this.insert=function(b,c,d){function e(a){var b;g.options.crossdomain?"string"==typeof a?(b=!1,g.events.trigger("error","insert",a.length>0?a:"Empty response. Was expecting new created records with ROWID.")):(b=!0,f||g.events.trigger("insert",a)):a?(b=!0,f||g.events.trigger("insert",a)):(b=!1,g.events.trigger("error","insert","Empty response. Was expecting new created records with ROWID.")),f||(g.events.triggerAfter("insert",b,a,h),b&&g.events.trigger("change","insert",a)),"function"==typeof c&&c.call(g,b,a,h)}d=d||{};var f=d&&d.disableEvents,h=b;try{f||g.events.triggerBefore("insert",h,d),this.options.crossdomain&&(h.crossdomain="put"),d&&d.dataSets&&(h.__dataSets=d.dataSets),d&&d.clientUID&&(h.__clientUID=d.clientUID),a.ajax({type:this.options.crossdomain?"GET":"PUT",data:h,dataType:this.options.crossdomain?"jsonp":"json",url:this.options.restServiceUrl+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){e(a)},error:function(a,b,d){if(br.isUnloading());else{var e=br.isEmpty(a.responseText)?a.statusText:a.responseText;f||(g.events.trigger("error","insert",e),g.events.triggerAfter("insert",!1,e,h)),"function"==typeof c&&c.call(g,!1,e,h)}}})}catch(i){br.log(i),f||(g.events.trigger("error","insert",i),g.events.triggerAfter("insert",!1,i,h)),"function"==typeof c&&c.call(g,!1,i,h)}return this},this.update=function(b,c,d,e){function f(a){var e="update";if(a){var f=g.events.trigger("removeAfterUpdate",c,a);null!==f&&f?(e="remove",h||g.events.trigger("remove",b)):h||g.events.trigger("update",a,b)}h||(g.events.triggerAfter(e,!0,a,i),g.events.trigger("change",e,a)),"function"==typeof d&&d.call(g,!0,a,i)}e=e||{};var h=e&&e.disableEvents,i=c;try{h||(g.events.triggerBefore("update",i,e,b),h=e&&e.disableEvents),this.options.crossdomain&&(i.crossdomain="post"),e&&e.dataSets&&(i.__dataSets=e.dataSets),e&&e.clientUID&&(i.__clientUID=e.clientUID),a.ajax({type:this.options.crossdomain?"GET":"POST",data:i,dataType:this.options.crossdomain?"jsonp":"json",url:this.options.restServiceUrl+b+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){f(a)},error:function(a,b,c){if(br.isUnloading());else{var e=br.isEmpty(a.responseText)?a.statusText:a.responseText;h||(g.events.trigger("error","update",e),g.events.triggerAfter("update",!1,e,i)),"function"==typeof d&&d.call(g,!1,e,i)}}})}catch(j){br.log(j),h||(g.events.trigger("error","update",j),g.events.triggerAfter("update",!1,j,i)),"function"==typeof d&&d.call(g,!1,j,i)}return this},this.remove=function(b,c,d){function e(a){f||(g.events.trigger("remove",b),g.events.triggerAfter("remove",!0,a,h),g.events.trigger("change","remove",a)),"function"==typeof c&&c.call(g,!0,a,h)}d=d||{};var f=d&&d.disableEvents,h={};try{f||g.events.triggerBefore("remove",h,d,b),this.options.crossdomain&&(h.crossdomain="delete"),d&&d.dataSets&&(h.__dataSets=d.dataSets),d&&d.clientUID&&(h.__clientUID=d.clientUID),a.ajax({type:this.options.crossdomain?"GET":"DELETE",data:h,dataType:this.options.crossdomain?"jsonp":"json",url:this.options.restServiceUrl+b+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){e(a)},error:function(a,b,d){if(br.isUnloading());else{var e=br.isEmpty(a.responseText)?a.statusText:a.responseText;f||(g.events.trigger("error","remove",e),g.events.triggerAfter("remove",!1,e,h)),"function"==typeof c&&c.call(g,!1,e,h)}}})}catch(i){br.log(i),f||(g.events.trigger("error","remove",i),g.events.triggerAfter("remove",!1,i,h)),"function"==typeof c&&c.call(g,!1,i,h)}return this},this.selectCount=function(a,b,c){"function"==typeof a&&(c=b,b=a);var d={};for(var e in a)d[e]=a[e];return d.__result="count",c=c||{},c.selectCount=!0,this.select(d,b,c),this},this.selectOne=function(a,b,c){return br.isFunction(a)&&(c=b,b=a,a={}),c=c||{},c.selectOne=!0,c.limit=1,br.isEmpty(a)?this.select(a,b,c):br.isNumber(a)||br.isObject(a)?br.isNumber(a)?this.select({rowid:a},b,c):this.select(a,b,c):(e("Unacceptable filter parameters",a,b,c),this)},this.doingSelect=function(){return h>0},this.select=function(b,c,d){var i,j={};br.isFunction(b)&&(d=c,c=b,b={}),d=d||{};var k=d&&d.disableEvents,l=d&&d.selectOne;if(l&&(d.limit=1),!br.isEmpty(b)){if(!br.isNumber(b)&&!br.isObject(b))return e("Unacceptable filter parameters",b,c,d),this;br.isNumber(b)&&(b={rowid:b});for(var m in b)"rowid"==m&&l?i=b[m]:j[m]=b[m]}var n=this.options.restServiceUrl;l&&i&&(n+=i);var o=!0;if(!k)try{g.events.triggerBefore("select",j,d)}catch(p){br.log(p),o=!1}return o&&(br.isEmpty(this.options.limit)||(j.__limit=this.options.limit),d&&!br.isEmpty(d.skip)&&(j.__skip=d.skip),d&&!br.isEmpty(d.limit)&&(j.__limit=d.limit),d&&d.fields&&(j.__fields=d.fields),d&&d.dataSets&&(j.__dataSets=d.dataSets),d&&d.clientUID&&(j.__clientUID=d.clientUID),d&&d.excludeFields&&(j.__excludeFields=d.excludeFields),d&&d.renderMode&&(j.__renderMode=d.renderMode),d&&d.order&&(j.__order=d.order),d&&d.page&&(j.__page=d.page),this.options.crossdomain&&(j.crossdomain="get"),h++,this.ajaxRequest=a.ajax({type:"GET",data:j,dataType:this.options.crossdomain?"jsonp":"json",url:n+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){try{g.ajaxRequest=null,g.options.crossdomain&&"string"==typeof a?e("Unknown error",j,c,d):br.isNull(a)?e("Unknown error",j,c,d):f(a,j,c,d)}finally{h--}},error:function(a,b,f){try{if(br.isUnloading());else{g.ajaxRequest=null;var i=br.isEmpty(a.responseText)?a.statusText:a.responseText;e(i,j,c,d)}}finally{h--}}})),this},this.requestInProgress=function(){return null!==this.ajaxRequest},this.abortRequest=function(){return null!==this.ajaxRequest&&this.ajaxRequest.abort(),this},this.invoke=function(b,c,d,e){br.isFunction(c)&&(e=d,d=c,c={}),d&&!br.isFunction(d)&&(e=d,d=void 0);var f=c||{};return e=e||{},g.events.triggerBefore(b,f),this.options.crossdomain&&(f.crossdomain="post"),e&&e.dataSets&&(f.__dataSets=e.dataSets),e&&e.clientUID&&(f.__clientUID=e.clientUID),a.ajax({type:this.options.crossdomain?"GET":"POST",data:f,dataType:this.options.crossdomain?"jsonp":"json",url:this.options.restServiceUrl+b+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){g.options.crossdomain&&"string"==typeof a?(g.events.trigger("error",b,a),g.events.triggerAfter(b,!1,a,f),"function"==typeof d&&d.call(g,!1,a,f)):(g.events.trigger(b,a,c),g.events.triggerAfter(b,!0,a,f),"function"==typeof d&&d.call(g,!0,a,f))},error:function(a,c,e){if(br.isUnloading());else{var h=br.isEmpty(a.responseText)?a.statusText:a.responseText;g.events.trigger("error",b,h),g.events.triggerAfter(b,!1,h,f),"function"==typeof d&&d.call(g,!1,h,f)}}}),this},this.fillCombo=function(b,c,d){d=d||{};var e=d.valueField||"rowid",f=d.nameField||"name",g=d.hideEmptyValue||!1,h=d.emptyValue||"--any--",i=d.selectedValue||null,j=d.selectedValueField||null;a(b).each(function(){var b=a(this).val();br.isEmpty(b)&&(b=a(this).attr("data-value"),a(this).removeAttr("data-value")),a(this).html("");var d="";g||(d=d+'<option value="">'+h+"</option>");for(var k in c)!i&&j&&"1"==c[k][j]&&(i=c[k][e]),d=d+'<option value="'+c[k][e]+'">'+c[k][f]+"</option>";a(this).html(d),br.isEmpty(i)||(b=i),br.isEmpty(b)||a(this).find("option[value="+b+"]").attr("selected","selected")})};var i;this.deferredSelect=function(a,c,d){d=d||this.options.refreshDelay;var e={};for(var f in a)e[f]=a[f];b.clearTimeout(i),i=b.setTimeout(function(){g.select(e,c)},d)}}b.br=b.br||{},b.br.dataSource=function(a,b){return new c(a,b)}}(jQuery,window),function(a,b){function c(c,d){function e(){var b=0,c=0,d=0,e=0,f=0,g=0;h.find("tbody tr:first td").each(function(h){var i=a(this).innerWidth(),j=a(this).outerWidth();f+=j,g+=j,i>d&&(d=i,b=h),j>e&&(e=j,c=h)});var i=(a(h).innerWidth(),a(h).outerWidth()),j=f-(f-d),k=i-(g-e);return{widestCellByInnerWidth:b,widestCellByOuterWidth:b,suggestedInnerWidth:j,suggestedOuterWidth:k}}function f(){var c=a(h).find("thead tr:first th");if(g.options.autoHeight){var d=a(b).height(),f=a("tbody",h),i=(a("thead",h),f.offset().top),l=d-i-24;a(f).height(l)}var m=a(h).find("tbody tr:first td");if(m.length>0){k?c.each(function(b){a(this).outerWidth(j[b])}):(c.each(function(b){j[b]=a(this).outerWidth()}),k=!0);var n=e();a(m[n.widestCellByOuterWidth]).outerWidth(0),m.each(function(b){if(b!=n.widestCellByOuterWidth){var d=a(c[b]),e=a(this).outerWidth(),f=Math.max(e,j[b]);a(this).outerWidth(f),e=a(this).outerWidth(),f=Math.max(e,j[b]),d.outerWidth(f)}}),n=e(),a(m[n.widestCellByOuterWidth]).outerWidth(n.suggestedOuterWidth),m.each(function(b){var d=a(c[b]),e=a(this).outerWidth();d.outerWidth(e)}),a(h).find("img").on("load",function(){a(this).data("bright-fixed-table-loaded")||(a(this).data("bright-fixed-table-loaded",!0),g.update())})}}var g=this,h=a(c);g.options=d||{},a("thead",h).css("display","block"),a("tbody",h).css("display","block").css("overflow","auto");var i,j=(a(h).find("thead tr:first th"),{}),k=!1;return this.update=function(){b.clearTimeout(i),i=b.setTimeout(function(){f()},100)},a(b).on("resize",function(){g.update()}),a(b).on("scroll",function(){g.update()}),g.update(),this}b.br=b.br||{},b.br.table=function(b,d){return new c(a(b),d)}}(jQuery,window),function(a,b){function c(b,c,d,e){function f(){g.isEmpty()&&(g.events.triggerBefore("nodata"),a(g.selector).html(g.templates.noData()),g.events.trigger("nodata"),g.events.triggerAfter("nodata"))}var g=this;this.selector=b,this.options=e||{},this.options.templates=this.options.templates||{},this.options.templates.row=a(c).html(),this.options.templates.groupRow=this.options.templates.groupRow?a(this.options.templates.groupRow).html():"",this.options.templates.header=this.options.templates.header?a(this.options.templates.header).html():"",this.options.templates.footer=this.options.templates.footer?a(this.options.templates.footer).html():"",this.options.templates.noData=this.options.templates.noData?a(this.options.templates.noData).html():"",this.options.templates.row=this.options.templates.row||"",this.options.templates.groupRow=this.options.templates.groupRow||"",this.options.templates.header=this.options.templates.header||"",this.options.templates.footer=this.options.templates.footer||"",this.options.templates.noData=this.options.templates.noData||"",this.templates={},this.templates.row=this.options.templates.row.length>0?br.compile(this.options.templates.row):function(){return""},this.templates.groupRow=this.options.templates.groupRow.length>0?br.compile(this.options.templates.groupRow):function(){return""},this.templates.header=this.options.templates.header.length>0?br.compile(this.options.templates.header):function(){return""},this.templates.footer=this.options.templates.footer.length>0?br.compile(this.options.templates.footer):function(){return""},this.templates.noData=this.options.templates.noData.length>0?br.compile(this.options.templates.noData):function(){return""},this.options.selectors=this.options.selectors||{},this.options.selectors.header=this.options.selectors.header||this.options.headersSelector||this.selector,this.options.selectors.footer=this.options.selectors.footer||this.options.footersSelector||this.selector,this.options.selectors.remove=this.options.selectors.remove||this.options.deleteSelector||".action-delete",this.options.dataSource=d,this.dataSource=this.options.dataSource,this.storageTag=this.options.storageTag?this.options.storageTag:document.location.pathname+":"+this.dataSource.options.restServiceUrl,this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)},this.options.fixedHeader&&(this.table=br.table(a(this.selector).closest("table"),e));var h=!1;g.loadingMoreData=!1,this.after("insert",function(a){g.events.trigger("change",a,"insert"),g.events.triggerAfter("change",a,"insert")}),this.after("update",function(a){g.events.trigger("change",a,"update"),g.events.triggerAfter("change",a,"update")}),this.after("remove",function(a){g.events.trigger("change",a,"remove"),g.events.triggerAfter("change",a,"remove")}),this.after("change",function(){this.table&&this.table.update()});var i=!1;return this.setStored=function(a,b){br.storage.set(this.storageTag+"stored:"+a,b);
},this.getStored=function(a,b){return br.storage.get(this.storageTag+"stored:"+a,b)},this.disconnectFromDataSource=function(){i=!0},this.reconnectWithDataSource=function(){i=!1},this.renderHeader=function(b,c){b=g.events.trigger("renderHeader",b)||b;var d=g.templates.header(b);if(c)return d;if(d.length>0){var e=a(d);return e.data("data-row",b),e}return null},this.renderFooter=function(b,c){b=g.events.trigger("renderFooter",b)||b;var d=g.templates.footer(b);if(c)return d;if(d.length>0){var e=a(d);return e.data("data-row",b),e}return null},this.renderRow=function(b,c){b=g.events.trigger("renderRow",b)||b;var d=g.templates.row(b).trim();if(c)return d;if(d.length>0){var e=a(d);return e.data("data-row",b),e}return null},this.renderGroupRow=function(b,c){b=g.events.trigger("renderGroupRow",b)||b;var d=g.templates.groupRow(b).trim();if(c)return d;if(d.length>0){var e=a(d);return e.data("data-row",b),e}return null},this.prepend=function(b){return a(g.selector).prepend(b)},this.append=function(b){return a(g.selector).append(b)},this.insertDataRowAfter=function(b,c){var d=g.renderRow(b);return d&&a(d).insertAfter(c),d},this.addDataRow=function(a){var b=g.renderRow(a);return b&&(g.events.triggerBefore("insert",a,b),g.events.trigger("insert",a,b),g.options.appendInInsert?g.append(b):g.prepend(b),g.events.triggerAfter("renderRow",a,b),g.events.triggerAfter("insert",a,b)),b},this.hasRow=function(b){var c=a(g.selector).find("[data-rowid="+b+"]");return c.length>0},this.reloadRow=function(b,c,d){br.isEmpty(c)||br.isFunction(c)||(d=c,c=null),d=d||{},d.disableEvents=!0,d.refreshSelector=d.refreshSelector||g.options.selectors.refreshRow;var e;e=br.isObject(b)?b:{rowid:b},g.dataSource.select(e,function(b,e){b&&0!==e.length?(e=e[0],g.refreshRow(e,d)||(g.isEmpty()&&a(g.selector).html(""),g.addDataRow(e)),"function"==typeof c&&c.call(g,e)):g.refresh(c)},d)},this.removeRow=function(b){var c=a(g.selector).find("[data-rowid="+b+"]");c.length>0?(g.events.triggerBefore("remove",b),g.events.trigger("remove",b,c),c.remove(),f(),g.events.triggerAfter("remove",b,c)):g.dataSource.select()},this.refresh=function(a){g.dataSource.select(function(){a&&a()})},this.refreshRow=function(b,c){var d="[data-rowid="+b.rowid+"]";c=c||{},c.refreshSelector=c.refreshSelector||g.options.selectors.refreshRow,c.refreshSelector&&(d=c.refreshSelector+d);var e=a(g.selector).find(d);if(e.length>0){var f=g.renderRow(b);return!!f&&(f.data("data-row",b),g.events.triggerBefore("update",b),g.events.trigger("update",b,e),a(e[0]).before(f),e.remove(),g.events.triggerAfter("renderRow",b,f),g.events.triggerAfter("update",b,f),!0)}return!1},this.getOrder=function(){var a=g.getOrderAndGroup(),b={};if(br.isArray(a))for(var c=0;c<a.length;c++)a[c].asc?b[a[c].fieldName]=1:b[a[c].fieldName]=-1;return b},this.setOrder=function(a){var b=[];for(var c in a)b.push({fieldName:c,asc:a[c]>0,group:!1,index:b.length});return a},this.setOrderAndGroup=function(a){return br.storage.set(this.storageTag+"orderAndGroup",a),a},this.getOrderAndGroup=function(){var a=br.storage.get(this.storageTag+"orderAndGroup",[]);return!br.isEmpty(a)&&br.isArray(a)||(a=[]),a},this.isOrderConfigured=function(){var a=g.getOrderAndGroup();return br.isArray(a)&&a.length>0},this.loadMore=function(a){h||g.loadingMoreData||(g.loadingMoreData=!0,g.dataSource.select({},function(b,c){"function"==typeof a&&a.call(g,b,c),g.loadingMoreData=!1},{loadingMore:!0}))},this.isEmpty=function(){return 0===a(g.selector).find("[data-rowid]").length},this.getKeys=function(b){var c=[];return b||(b="data-rowid"),a("["+b+"]",a(g.selector)).each(function(){c.push(br.toInt(a(this).attr(b)))}),c},this.init=function(){function b(b){for(var c=0;c<b.length;c++){var d=a('.sortable[data-field="'+b[c].fieldName+'"].'+(b[c].asc?"order-asc":"order-desc"),a(g.options.selectors.header));d.addClass("icon-white").addClass("icon-border");var e=d.parent().find("div.br-sort-index");b.length>1&&(e.length>0?e.text(c+1):d.parent().append(a('<div class="br-sort-index">'+(c+1)+"</div>")))}}var c=g.getOrderAndGroup();br.isArray(c)&&0!==c.length||g.options.defaultOrderAndGroup&&g.setOrderAndGroup(g.options.defaultOrderAndGroup),b(g.getOrderAndGroup()),a(this.options.selectors.header).on("click",".sortable",function(c){var d=a(this).hasClass("icon-white")||a(this).hasClass("icon-border");c.metaKey||(a(".sortable",a(g.options.selectors.header)).removeClass("icon-white").removeClass("icon-border"),a(".br-sort-index",a(g.options.selectors.header)).remove()),d?a(this).removeClass("icon-white").removeClass("icon-border"):(a(this).siblings("i").removeClass("icon-white").removeClass("icon-border"),a(this).addClass("icon-white").addClass("icon-border"));var e,f=a(this).attr("data-field"),h={fieldName:f,asc:a(this).hasClass("order-asc"),group:a(this).hasClass("group-by")};if(c.metaKey||c.altKey||c.ctrlKey||c.shiftKey){e=g.getOrderAndGroup();for(var i=[],j=0;j<e.length;j++)e[j].fieldName!=f&&i.push(e[j]);e=i}else e=[];d||e.push(h),b(e),g.setOrderAndGroup(e),g.events.triggerBefore("changeOrder",e),g.dataSource.select()}),g.dataSource&&(g.dataSource.before("select",function(a,b){b.order=g.getOrder(),!g.loadingMoreData}),g.dataSource.after("select",function(b,c,d){a(g.selector).removeClass("progress-big"),b&&(h=0===c.length,i||g.render(c,g.loadingMoreData))}),g.dataSource.after("insert",function(b,c){b&&(g.isEmpty()&&a(g.selector).html(""),g.addDataRow(c))}),g.dataSource.on("update",function(a){g.refreshRow(a,g.options)||g.dataSource.select()}),g.dataSource.on("remove",function(a){g.removeRow(a)}),this.options.selectors.remove&&a(g.selector).on("click",this.options.selectors.remove,function(){var b=a(this).closest("[data-rowid]");if(b.length>0){var c=a(b).attr("data-rowid");br.isEmpty(c)||br.confirm("Delete confirmation","Are you sure you want to delete this record?",function(){g.dataSource.remove(c)})}}),br.isString(g.selector)&&br.editable(g.selector+" .editable",function(b){var c=a(this),d=c.closest("[data-rowid]").attr("data-rowid"),e=c.attr("data-field");if(!br.isEmpty(d)&&!br.isEmpty(e)){var f={};f[e]=b,g.dataSource.update(d,f,function(a,d){a&&g.events.trigger("editable.update",c,b)})}}))},this.render=function(b,c){var d,e=a(g.selector);if(g.events.triggerBefore("change",b,"render"),b){var f,h,i;if(c||e.html(""),g.options.freeGrid){if(b=b[0],b.headers)for(f in b.headers)b.headers[f]&&(d=g.renderHeader(b.headers[f]),d&&a(g.options.selectors.header).append(d));if(b.footers)for(f in b.footers)b.footers[f]&&(d=g.renderFooter(b.headers[f]),d&&a(g.options.selectors.footer).append(d));if(a(g.options.selectors.header).html(""),a(g.options.selectors.footer).html(""),b.rows)if(0===b.rows.length)e.html(g.templates.noData());else for(f in b.rows)b.rows[f]&&(b.rows[f].row&&(d=g.renderRow(b.rows[f].row),d&&e.append(d)),b.rows[f].header&&(d=g.renderHeader(b.rows[f].header),d&&a(g.options.selectors.header).append(d)),b.rows[f].footer&&(d=g.renderFooter(b.rows[f].footer),d&&a(g.options.selectors.footer).append(d)));else e.html(g.templates.noData())}else if(b&&b.length>0){var j=g.getOrderAndGroup(),k={},l="";for(f=0;f<b.length;f++)if(b[f]){if(br.isArray(j)){for(i=0;i<j.length;i++)if(l=j[i].fieldName,j[i].group&&k[l]!=b[f][l]){for(h=i;h<j.length;h++)l=j[h].fieldName,k[l]=void 0;break}for(i=0;i<j.length;i++)if(l=j[i].fieldName,j[i].group&&k[l]!=b[f][l]){k[l]=b[f][l];var m=b[f];m.__groupBy={},m.__groupBy.__field=l,m.__groupBy.__value=b[f][l],m.__groupBy[l]=!0,d=g.renderGroupRow(m),d&&(e.append(d),g.events.triggerAfter("renderGroupRow",b[f],d))}}d=g.renderRow(b[f]),d&&(e.append(d),g.events.triggerAfter("renderRow",b[f],d))}}else c||e.html(g.templates.noData())}else e.html(g.templates.noData());g.events.trigger("change",b,"render"),g.events.triggerAfter("change",b,"render")},this.init()}b.br=b.br||{},b.br.dataGrid=function(a,b,d,e){return new c(a,b,d,e)}}(jQuery,window),function(a,b){function c(c,d,e){function f(b){var c=k.storageTag;return c+=":filter-value",br.isEmpty(a(b).attr("id"))?br.isEmpty(a(b).attr("name"))||(c=c+":"+a(b).attr("name")):c=c+":"+a(b).attr("id"),br.isEmpty(a(b).attr("data-storage-key"))||(c=c+":"+a(b).attr("data-storage-key")),c}function g(a){if(br.isFunction(k.options.onGetName))return k.options.onGetName.call(this,a);var b={value:a[k.options.keyField],name:a[k.options.nameField]};return k.events.trigger("formatItem",b,a),b.name}function h(){var a=50;if(k.isValid()&&b.Select2&&!k.options.noDecoration&&!k.selector.attr("size")){if(k.options.lookupMode&&l)return;var c={};k.options.hideSearchBox&&(c.minimumResultsForSearch=-1),k.options.skipTranslate&&(c.dropdownCssClass="skiptranslate"),k.options.allowClear&&(c.allowClear=k.options.allowClear,c.placeholder=k.options.emptyName),c.dropdownAutoWidth=!0,c.dropdownCss={"max-width":"400px"},k.options.lookupMode&&(c.minimumInputLength=k.options.lookup_minimumInputLength,c.allowClear=!0,c.placeholder=k.options.emptyName,c.query=function(c){b.clearTimeout(n);var d={};d.keyword=c.term,n=b.setTimeout(function(){c.term&&k.dataSource.select(d,function(a,b){if(a){for(var d={results:[]},e=0;e<b.length;e++)d.results.push({id:b[e][k.options.valueField],text:g(b[e])});c.callback(d)}},{limit:a,skip:(c.page-1)*a})},300)}),k.selector.select2(c),l=!0}}function i(a){var b="";if(b+=!br.isEmpty(k.options.groupField)&&br.toInt(a[k.options.groupField])>0?"<optgroup":"<option",b=b+' value="'+a[k.options.valueField]+'"',!br.isEmpty(k.options.disabledField)&&br.toInt(a[k.options.disabledField])>0&&(b+=' disabled="disabled"'),b+=">",!br.isEmpty(k.options.levelField))for(var c=4*(br.toInt(a[k.options.levelField])-1),d=0;d<c;d++)b+="&nbsp;";return b+=g(a),b+=!br.isEmpty(k.options.groupField)&&br.toInt(a[k.options.groupField])>0?"</optgroup>":"</option>"}function j(b){m=b,k.options.lookupMode||(k.options.saveSelection&&(k.options.saveToSessionStorage?k.options.selectedValue=br.session.get(f(k.selector)):k.options.selectedValue=br.storage.get(f(k.selector))),k.selector.each(function(){var c=a(this).val();br.isEmpty(c)&&(c=a(this).attr("data-value"),a(this).removeAttr("data-value")),a(this).html("");var d="",e={};e.data=b,k.options.hideEmptyValue||k.options.autoSelectSingle&&1==b.length||(e.s=d,k.events.triggerBefore("generateEmptyOption",e,a(this)),d=e.s,k.options.allowClear?d+="<option></option>":d=d+'<option value="'+k.options.emptyValue+'">'+k.options.emptyName+"</option>"),e.s=d,k.events.triggerBefore("generateOptions",e,a(this)),d=e.s;for(var f=0;f<b.length;f++)if(d+=i(b[f]),br.isEmpty(k.options.selectedValue)&&!br.isEmpty(k.options.selectedValueField)){var g=b[f][k.options.selectedValueField];(br.isBoolean(g)&&g||1==br.toInt(g))&&(k.options.selectedValue=b[f][k.options.valueField])}if(a(this).html(d),br.isEmpty(k.options.selectedValue)){if(!br.isEmpty(c))if(br.isArray(c))for(var h=0;h<c.length;h++)a(this).find("option[value="+c[h]+"]").attr("selected","selected");else a(this).find("option[value="+c+"]").attr("selected","selected")}else a(this).find("option[value="+k.options.selectedValue+"]").attr("selected","selected")}),h())}var k=this,l=!1,m=[];this.selector=a(c),this.dataSource=d,this.options=e||{},this.options.valueField=this.options.valueField||"rowid",this.options.nameField=this.options.nameField||"name",this.options.levelField=this.options.levelField||null,this.options.selectedValue=this.options.selectedValue||null,this.options.skipTranslate=this.options.skipTranslate||null,this.options.selectedValueField=this.options.selectedValueField||null,this.options.hideEmptyValue=this.options.hideEmptyValue||"multiple"==this.selector.attr("multiple"),this.options.emptyName=this.options.emptyName||"--any--",this.options.emptyValue=this.options.emptyValue||"",this.options.allowClear=this.options.allowClear||!1,this.options.lookupMode=this.options.lookupMode||!1,this.options.fields=this.options.fields||{},this.options.saveSelection=this.options.saveSelection||!1,this.options.saveToSessionStorage=this.options.saveToSessionStorage||!1,this.options.lookup_minimumInputLength=this.options.lookup_minimumInputLength||0,this.options.skipTranslate&&this.selector.addClass("skiptranslate"),this.loaded=this.options.lookupMode,this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)},this.storageTag=this.options.storageTag?this.options.storageTag:document.location.pathname,this.dataSource&&(this.storageTag=this.storageTag+":"+this.dataSource.options.restServiceUrl),this.isValid=function(){return k.selector.length>0},this.isLoaded=function(){return k.loaded},this.hasOptions=function(){return k.selector.find("option").length>0},this.optionsAmount=function(){return k.selector.find("option").length},this.getFirstAvailableValue=function(){var b=null;return k.selector.find("option").each(function(){br.isEmpty(a(this).val())||br.isEmpty(b)&&(b=a(this).val())}),b};var n;this.selected=function(a){if(br.isArray(m)&&m.length>0){var b=this.val();if(!br.isEmpty(b))for(var c=0;c<m.length;c++)if(br.toInt(m[c][k.options.valueField])==br.toInt(b))return br.isEmpty(a)?m[c]:m[c][a]}},this.val=function(a,b){if(void 0!==a&&(k.options.saveSelection&&(k.options.saveToSessionStorage?br.session.set(f(k.selector),a):br.storage.set(f(k.selector),a)),k.isValid()))if(k.selector.val(a),h(),k.options.lookupMode)if(a){var c={id:a,text:a},d={rowid:a};k.selector.select2("data",c),k.dataSource.select(d,function(a,d){a&&d.length>0&&(d=d[0],c={id:d[k.options.valueField],text:g(d)},k.selector.select2("data",c)),b&&b.call(k.selector,a,d)},{disableEvents:!0})}else k.selector.select2("data",null),b&&b.call(k.selector,!0,a);else b&&b.call(k.selector,!0,a);if(k.isValid()){var e=k.selector.val();return null!==e?e:void 0}},this.valOrNull=function(){if(k.isValid()){var a=this.val();return br.isEmpty(a)?null:a}},this.reset=function(a){br.storage.remove(f(this.selector)),br.session.remove(f(this.selector)),k.isValid()&&(this.selector.val(""),a?k.selector.trigger("change"):h())},this.selector.on("reset",function(){k.reset()}),k.load=k.reload=function(a,b){if("function"==typeof a&&(b=a,a={}),k.dataSource)if(k.isValid())if(k.options.lookupMode){if(b){var c=!0,d=[];b.call(k.selector,c,d)}h()}else k.dataSource.select(a,function(a,c){a&&(b&&b.call(k.selector,a,c),h(),k.loaded=!0)},{fields:k.options.fields});else b&&b.call(k.selector,!0,[]),k.loaded=!0,k.events.trigger("load",[])},k.dataSource?(k.dataSource.on("select",function(a){k.isValid()&&(k.options.lookupMode||j(a)),k.events.trigger("load",a)}),k.dataSource.after("insert",function(b,c){b&&k.isValid()&&(k.options.lookupMode||(k.selector.append(a(i(c))),h())),k.events.trigger("change")}),k.dataSource.after("update",function(a,b){a&&k.isValid()&&(k.options.lookupMode||b[k.options.valueField]&&(k.selector.find("option[value="+b[k.options.valueField]+"]").text(g(b)),h())),k.events.trigger("change")}),k.dataSource.after("remove",function(a,b){a&&k.isValid()&&(k.options.lookupMode||b[k.options.valueField]&&(k.selector.find("option[value="+b[k.options.valueField]+"]").remove(),h())),k.events.trigger("change")})):(k.options.saveSelection&&(k.options.saveToSessionStorage?k.options.selectedValue=br.session.get(f(k.selector)):k.options.selectedValue=br.storage.get(f(k.selector)),br.isEmpty(k.options.selectedValue)||k.val(k.options.selectedValue)),h()),k.selector.change(function(){k.options.saveSelection&&(k.options.saveToSessionStorage?br.session.set(f(this),a(this).val()):br.storage.set(f(this),a(this).val())),k.events.trigger("change"),h()}),this.selector.data("BrDataCombo",k)}b.br=b.br||{},b.br.dataCombo=function(a,b,d){return new c(a,b,d)}}(jQuery,window),function(a,b){function c(b,c){var d=this;d.ctrl=a(b),br.isFunction(c)&&(c={onSave:c}),c=c||{},d.options=c,d.options.popover_placement=d.ctrl.attr("data-popover-placement")||"bottom",d.editor=null,d.savedWidth="",d.click=function(b,c){if(!d.activated()){var e="";e="undefined"!=typeof d.ctrl.attr("data-editable")?d.ctrl.attr("data-editable"):d.ctrl.text(),d.ctrl.data("brEditable-original-html",d.ctrl.html()),d.ctrl.data("brEditable-original-width",d.ctrl.css("width"));d.ctrl.innerWidth(),d.ctrl.innerHeight();d.ctrl.text("");var f="textarea"==d.ctrl.attr("data-editable-type");f?d.editor=a('<textarea rows="3"></textarea>'):d.editor=a('<input type="text" />'),d.editor.addClass("form-control"),d.editor.css("width","100%"),d.editor.css("height","100%"),d.editor.css("min-height","30px"),d.editor.css("font-size",d.ctrl.css("font-size")),d.editor.css("font-weight",d.ctrl.css("font-weight")),d.editor.css("box-sizing","100%"),d.editor.css("-webkit-box-sizing","border-box"),d.editor.css("-moz-box-sizing","border-box"),d.editor.css("-ms-box-sizing","border-box"),d.editor.css("margin-top","2px"),d.editor.css("margin-bottom","2px"),d.ctrl.attr("data-editable-style")&&d.editor.attr("style",d.ctrl.attr("data-editable-style")),d.ctrl.append(d.editor),d.options.onGetContent&&(e=d.options.onGetContent.call(d.ctrl,d.editor,e)),d.editor.val(e),d.editor.focus(),a("div.popover").remove(),d.options.hideHint||(d.options.saveOnLoosingFocus||f?f?d.editor.popover({placement:d.options.popover_placement,animation:!1,trigger:"manual",content:"WARNING!!! Changes will be saved after leaving input box or by pressing [Tab]. Press [Esc] to cancel changes."}):d.editor.popover({placement:d.options.popover_placement,animation:!1,trigger:"manual",content:"WARNING!!! Changes will be saved after leaving input box, by pressing [Enter], or by pressing [Tab]. Press [Esc] to cancel changes."}):d.editor.popover({placement:d.options.popover_placement,animation:!1,trigger:"manual",content:"Press [Enter] to save changes, [Esc] to cancel changes."})),d.editor.popover("show"),(d.options.saveOnLoosingFocus||f)&&(a(d.editor).on("keydown",function(b){if(9==b.keyCode){var c=a(this).val();a("div.popover").remove(),d.options.onSave?d.options.onSave.call(d.ctrl,c,"keyup"):d.apply(c),b.stopPropagation(),b.preventDefault()}}),a(d.editor).on("blur",function(b){a("div.popover").remove();var c=a(this).val();d.options.onSave?d.options.onSave.call(d.ctrl,c,"blur"):d.apply(c)})),a(d.editor).on("keyup",function(b){var c=a(this).val();switch(b.keyCode){case 13:a("div.popover").remove(),d.options.onSave?d.options.onSave.call(d.ctrl,c,"keyup"):d.apply(c),b.stopPropagation();break;case 27:a("div.popover").remove(),d.cancel(),b.stopPropagation()}})}},d.activated=function(){return null!==d.editor},d.apply=function(b){a("div.popover").remove(),d.editor.remove(),d.editor=null,d.ctrl.html(b),"undefined"!=typeof d.ctrl.attr("data-editable")&&d.ctrl.attr("data-editable",b),d.ctrl.css("width","")},d.cancel=function(){a("div.popover").remove(),d.editor.remove(),d.editor=null,d.ctrl.html(d.ctrl.data("brEditable-original-html")),d.ctrl.css("width","")}}b.br=b.br||{},b.br.editable=function(b,d,e){if(0===a("#br_editablePopover").length&&a("body").append(a('<div id="br_editablePopover"></div>')),"string"==typeof d){var f=a(b).data("brEditable-editable");f||a(b).data("brEditable-editable",f=new c(a(b),d)),f&&f[d](e)}else a(document).on("click",b,function(b){var e=a(this),f=e.data("brEditable-editable");f||e.data("brEditable-editable",f=new c(this,d)),f.click(b)})}}(jQuery,window),function(a,b){function c(a){var b=Math.floor(Math.log(a)/Math.log(1024));return 1*(a/Math.pow(1024,b)).toFixed(2)+" "+["B","kB","MB","GB","TB"][b]}function d(){var b=Math.round(100*k/j);a("#br_progressBar_Bar").css("width",b+"%"),a("#br_progressMessage").text(l),"upload"==i?a("#br_progressStage").text(c(k)+" of "+c(j)):a("#br_progressStage").text(k+" of "+j)}function e(c){a(c).data("brAutoSizeConfigured")||!function(c){2==br.bootstrapVersion&&(c.css("top","20px"),c.css("margin-top","0px")),c.on("shown.bs.modal",function(){br.resizeModalPopup(c)}),a(b).resize(function(){br.resizeModalPopup(c)}),c.data("brAutoSizeConfigured",1)}(a(c))}function f(b){void 0!==a.ui&&a(b).each(function(){a(this).attr("data-format")?a(this).datepicker({dateFormat:a(this).attr("data-format")}):a(this).datepicker({})})}function g(b){try{a(b).each(function(){a(this).bootstrapDatepicker({todayBtn:"linked",clearBtn:!0,multidate:!1,autoclose:!0,todayHighlight:!0})})}catch(c){br.log("[ERROR] bootstrapDatepicker expected but script was not loaded")}}b.br=b.br||{},b.br.bootstrapVersion=0,b.br.showError=function(a){alert(a)},b.br.growlError=function(c,d){br.isEmpty(c)||("undefined"!=typeof a.gritter?a.gritter.add({title:br.trn("Error"),text:c,class_name:"gritter-red",image:d}):"undefined"!=typeof b.humane?humane.log(c,{addnCls:"humane-jackedup-error humane-original-error",timeout:5e3}):alert(c))},b.br.showMessage=function(a){br.isEmpty(a)||alert(a)},b.br.growlMessage=function(c,d,e){br.isEmpty(c)||("undefined"!=typeof a.gritter?(br.isEmpty(d)&&(d=" "),a.gritter.add({title:d,text:c,class_name:"gritter-light",image:e})):"undefined"!=typeof b.humane?humane.log(c):alert(c))},b.br.panic=function(b){throw a(".container").html('<div class="row"><div class="span12"><div class="alert alert-error"><h4>'+br.trn("Error")+"!</h4><p>"+b+"</p></div></div></div>"),""},b.br.confirm=function(b,c,d,e,f){"function"==typeof d&&(f=e,e=d,d=null),f=f||{},f.cancelTitle=f.cancelTitle||br.trn("Cancel"),f.onConfirm=f.onConfirm||e;var g,h='<div class="modal modal-autosize';f.cssClass&&(h=h+" "+f.cssClass),h+='" id="br_modalConfirm"',2==br.bootstrapVersion&&(h+=' style="top:20px;margin-top:0px;"'),h+=">";var i="";if(f.checkBoxes)for(g in f.checkBoxes){var j=f.checkBoxes[g],k="";j["default"]&&(k="checked"),i=i+'<div class="checkbox"><label class="checkbox"><input type="checkbox" class="confirm-checkbox" name="'+j.name+'" value="1" '+k+"> "+j.title+"</label></div>"}if(h=h+'<div class="modal-dialog"><div class="modal-content"><div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3 class="modal-title">'+b+'</h3></div><div class="modal-body" style="overflow-y:auto;">'+c+i+'</div><div class="modal-footer">',f.showDontAskMeAgain){var l=f.dontAskMeAgainTitle?f.dontAskMeAgainTitle:br.trn("Don't ask me again");h=h+'<label style="text-align:left;float:left;padding-top:5px;" class="checkbox"><input name="showDontAskMeAgain" type="checkbox" value="1"> '+l+"</label>"}if(br.isEmpty(d)){var m=f.yesTitle||br.trn("Yes"),n=f.yesLink||"javascript:;";h=h+'<a href="'+n+'" class="btn btn-sm btn-primary action-confirm-close" rel="confirm">&nbsp;'+m+"&nbsp;</a>"}else for(g in d)h=h+'<a href="javascript:;" class="btn btn-sm btn-default action-confirm-close" rel="'+g+'">&nbsp;'+d[g]+"&nbsp;</a>";h=h+'<a href="javascript:;" class="btn btn-sm btn-default action-confirm-cancel" rel="cancel">&nbsp;'+f.cancelTitle+"&nbsp;</a>",h+="</div></div></div></div>";var o=a(h),p=document.activeElement;p&&p.blur();var q=!0,r=function(b){if(f.defaultButton){var c=a(this).find(".modal-footer a.btn[rel="+f.defaultButton+"]");c.length>0&&c[0].focus()}},s=function(b){f.onShow&&f.onShow.call(o),a(this).find(".action-confirm-close").click(function(){var b=a(this).attr("rel"),c=a("input[name=showDontAskMeAgain]",a(o)).is(":checked"),d={};a("input.confirm-checkbox").each(function(){d[a(this).attr("name")]=a(this).is(":checked")}),q=!1,o.modal("hide"),f.onConfirm&&f.onConfirm.call(this,b,c,d),o.remove(),p&&p.focus()}),a(this).find(".action-confirm-cancel").click(function(){var b="cancel",c=a("input[name=showDontAskMeAgain]",a(o)).is(":checked");q=!1,o.modal("hide"),f.onCancel&&f.onCancel(b,c),o.remove(),p&&p.focus()})},t=function(b){if(f.onHide&&f.onHide.call(this),q){if(f.onCancel){var c="cancel",d=a("input[name=showDontAskMeAgain]",a(o)).is(":checked");f.onCancel(c,d)}o.remove(),p&&p.focus()}};return a(o).on("show.bs.modal",s),a(o).on("hide.bs.modal",t),a(o).on("shown.bs.modal",r),a(o).modal("show"),br.enchanceBootstrap(o),br.resizeModalPopup(o),o},b.br.error=function(b,c,d){var e='<div class="modal modal-autosize" id="br_modalError"';2==br.bootstrapVersion&&(e+=' style="top:20px;margin-top:0px;"'),e+='><div class="modal-dialog"><div class="modal-content">',""!==b&&(e=e+'<div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3 class="modal-title">'+b+"</h3></div>"),e=e+'<div class="modal-body" style="overflow-y:auto;">'+c+'</div><div class="modal-footer" style="background-color:red;">',e=e+'<a href="javascript:;" class="btn btn-sm btn-default" data-dismiss="modal">&nbsp;'+br.trn("Dismiss")+"&nbsp;</a><",e+="/div></div></div></div>";var f=a(e),g=document.activeElement;g&&g.blur();var h=function(a){d&&d.call(this),f.remove(),g&&g.focus()};return a(f).on("hide.bs.modal",h),a(f).modal("show"),br.enchanceBootstrap(f),br.resizeModalPopup(f),f},b.br.inform=function(b,c,d,e){d&&"function"!=typeof d&&(e=d,d=null),e=e||{};var f=e.buttonTitle||"Dismiss",g='<div class="modal modal-autosize" id="br_modalInform"';if(2==br.bootstrapVersion&&(g+=' style="top:20px;margin-top:0px;"'),g+='><div class="modal-dialog"><div class="modal-content">',""!==b&&(g=g+'<div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3 class="modal-title">'+b+"</h3></div>"),g=g+'<div class="modal-body" style="overflow-y:auto;">'+c+'</div><div class="modal-footer">',e.showDontAskMeAgain){var h=e.dontAskMeAgainTitle?e.dontAskMeAgainTitle:br.trn("Don't ask me again");g=g+'<label style="text-align:left;float:left;padding-top:5px;" class="checkbox"><input name="showDontAskMeAgain" type="checkbox" value="1"> '+h+"</label>"}g=g+'<a href="javascript:;" class="btn btn-sm btn-default" data-dismiss="modal">&nbsp;'+br.trn(f)+"&nbsp;</a></div></div></div></div>";var i=a(g),j=document.activeElement;j&&j.blur();var k=function(b){var c=a("input[name=showDontAskMeAgain]",a(i)).is(":checked");d&&d.call(this,c),i.remove(),j&&j.focus()};return a(i).on("hide.bs.modal",k),a(i).modal("show"),br.enchanceBootstrap(i),br.resizeModalPopup(i),i},b.br.prompt=function(b,c,d,e){e=e||{};var f={};br.isObject(c)?f=c:(e.valueRequired=!0,f[c]=""),e.onhide&&(e.onHide=e.onhide);var g='<div class="modal modal-autosize" id="br_modalPrompt"';2==br.bootstrapVersion&&(g+=' style="top:20px;margin-top:0px;"'),g=g+'><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3 class="modal-title">'+b+'</h3></div><div class="modal-body" style="overflow-y:auto;">';for(var h in f)g=br.isObject(f[h])?g+"<label>"+h+'</label><input type="text" '+(f[h].id?'id="'+f[h].id+'"':"")+' class="span4 '+(br.isEmpty(f[h]["class"])?"":f[h]["class"])+'" value="'+f[h].value+'" data-click-on-enter="#br_modalPrompt .action-confirm-close" />':g+"<label>"+h+'</label><input type="text" class="form-control '+("int"==e.valueType?" input-small":" justified")+(e.valueRequired?" required":"")+' " value="'+f[h]+'" data-click-on-enter="#br_modalPrompt .action-confirm-close" />';g+='</div><div class="modal-footer">',g+='<a href="javascript:;" class="btn btn-sm btn-primary action-confirm-close" rel="confirm" >Ok</a>',g=g+'<a href="javascript:;" class="btn btn-sm btn-default" data-dismiss="modal">&nbsp;'+br.trn("Cancel")+"&nbsp;</a>",g+="</div></div></div></div>";var i=a(g),j=document.activeElement;j&&j.blur();var k=!0,l=function(b){a(this).find("input[type=text]")[0].focus()},m=function(b){a(this).find(".action-confirm-close").click(function(){var b,c=[],f=!0,g=[];if(a(this).closest("div.modal").find("input[type=text]").each(function(){a(this).hasClass("required")&&br.isEmpty(a(this).val())&&(f=!1,b=a(this)),c.push(a(this).val().trim()),g.push(a(this))}),f){if(e.onValidate)try{e.onValidate.call(this,c)}catch(h){f=!1,br.growlError(h),1==g.length&&g[0].focus()}f&&(k=!1,a(i).modal("hide"),d&&d.call(this,c),i.remove(),j&&j.focus())}else br.growlError("Please enter value"),b[0].focus()})},n=function(a){e.onHide&&e.onHide.call(this),k&&(i.remove(),j&&j.focus())};return a(i).on("show.bs.modal",m),a(i).on("hide.bs.modal",n),a(i).on("shown.bs.modal",l),a(i).modal("show"),br.enchanceBootstrap(i),br.resizeModalPopup(i),i};b.br.compile=function(a){if(a){if("undefined"==typeof b.Mustache){if("undefined"==typeof b.Handlebars)throw"Template engine not linked";return Handlebars.compile(a)}return function(b){return Mustache.render(a,b)}}throw"Empty template"},b.br.fetch=function(a,c,d){if(c=c||{},a){if("undefined"==typeof b.Mustache){if("undefined"==typeof b.Handlebars)throw"Template engine not linked";var e=Handlebars.compile(a);return e(c)}return Mustache.render(a,c)}return""};var h=0;b.br.isAJAXInProgress=function(){return h>0},b.br.showAJAXProgress=function(){h++,a(".ajax-in-progress").css("visibility","visible")},b.br.hideAJAXProgress=function(){h--,h<=0&&(a(".ajax-in-progress").css("visibility","hidden"),h=0)},b.br.jsonEncode=function(a){return JSON.stringify(a)},b.br.jsonDecode=function(a){try{return JSON.parse(a)}catch(b){return null}};var i,j=0,k=0,l="",m='<div id="br_progressBar" class="modal" style="display:none;z-index:10000;top:20px;margin-top:0px;" data-backdrop="static">  <div class="modal-dialog">    <div class="modal-content">      <div class="modal-body">        <table style="width:100%;font-size:18px;font-weight:300;margin-bottom:10px;">          <tr>            <td id="br_progressMessage"></td>            <td align="right" id="br_progressStage" style="font-size:14px;font-weight:300;"></td>          </tr>        </table>        <div id="br_progressBar_Section" style="display:none;clear:both;">          <div style="margin-bottom:0px;padding:0px;height:20px;overflow: hidden;background-color: #f5f5f5;border-radius: 4px;box-shadow: inset 0 1px 2px rgba(0,0,0,.1);">            <div id="br_progressBar_Bar" style="background-color:#008cba;border:none;padding:0px;height:20px;"></div>          </div>        </div>        <div id="br_progressBarAnimation" style="display1:none;padding-top:10px;">          <center><img src="'+br.baseUrl+'bright/images/progress-h.gif" /></center>        </div>      </div>    </div>  </div></div>';b.br.startProgress=function(b,c,e){if(i=e,br.isNumber(b)||(c=b,b=0),j=b,k=0,l=c,0===a("#br_progressBar").length){var f=a(m);2==br.bootstrapVersion&&(f.css("top","20px"),f.css("margin-top","0px")),a("body").append(f)}j>1?(a("#br_progressBar_Section").show(),a("#br_progressStage").show()):(a("#br_progressBar_Section").hide(),a("#br_progressStage").hide()),a("#br_progressBar").modal("show"),d()},b.br.showProgress=function(){a("#br_progressBar").modal("show")},b.br.hideProgress=function(){a("#br_progressBar").modal("hide")},b.br.incProgress=function(a){a||(a=1),j+=a,d()},b.br.setProgress=function(a,b){k=a,br.isEmpty(b)||(l=b),d()},b.br.stepProgress=function(a,b){br.isNumber(a)?k+=a:(k++,b=a),br.isEmpty(b)||(l=b),d()},b.br.initScrollableAreas=function(c){a(".br-scrollable").each(function(){function d(){var d=0;0!==f.length&&(d=f.height()),c&&(d=0);var h=a(b).height()-d-g;if(h>0){var i=0;i=f.length>0?"static"==f.css("position")?g:d+g:g,e.css("margin-top",i+"px"),e.css("height",h+"px")}}var e=a(this).parent(".br-container"),f=a("nav.navbar");0===f.length&&(f=a("div.navbar"));var g=0;"static"!=f.css("position")&&(g=e.offset().top),c&&(g=0),a("body").css("overflow","hidden"),a(b).on("resize",function(){d()}),d()})},b.br.resizeModalPopup=function(c){var d=a(b).height()-a(c).find(".modal-header").outerHeight()-a(c).find(".modal-footer").outerHeight()-90;a(c).find(".modal-body").css("max-height",d+"px"),a(c).find(".modal-body").css("overflow-y","auto")},b.br.enchanceBootstrap=function(b){b?a(b).hasClass("modal-autosize")&&e(a(b)):a("div.modal.modal-autosize").each(function(){e(a(this))}),void 0!==a.ui&&(b?a(b).not(".ui-draggable").each(function(){a(this).find(".modal-header").length>0&&a(this).draggable({handle:".modal-header",cursor:"pointer"}).find(".modal-header").css("cursor","move")}):a(".modal").not(".ui-draggable").each(function(){a(this).find(".modal-header").length>0&&a(this).draggable({handle:".modal-header",cursor:"pointer"}).find(".modal-header").css("cursor","move")}))},b.br.attachDatePickers=function(b){b?(f(a("input.datepicker",b)),g(a("input.bootstrap-datepicker",b))):(f(a("input.datepicker")),g(a("input.bootstrap-datepicker")))},"object"==typeof b.Handlebars&&Handlebars.registerHelper("if_eq",function(a,b,c){
return a===b?c.fn(this):c.inverse(this)}),a(document).ready(function(){var b=!1;if(a.fn.modal?a.fn.modal.toString().indexOf("bs.modal")==-1?br.bootstrapVersion=2:br.bootstrapVersion=3:br.bootstrapVersion=0,2==br.bootstrapVersion&&(a.fn.modal.Constructor.prototype.enforceFocus=function(){}),a(document).ajaxStart(function(){br.showAJAXProgress()}),a(document).ajaxStop(function(){br.hideAJAXProgress()}),a(document).ajaxError(function(a,c,d,e){401==c.status&&(b||(b=!0,br.growlError(br.trn("You are trying to run operation which require authorization."))))}),a(document).on("keypress","input[data-click-on-enter]",function(b){13==b.keyCode&&a(a(this).attr("data-click-on-enter")).trigger("click")}),br.enchanceBootstrap(),br.attachDatePickers(),a(".focused").length>0)try{a(".focused")[0].focus()}catch(c){}if(!br.isTouchScreen){var d=a("body").attr("data-disable-bounce-container");br.isEmpty(d)||br.disableBounce(a(d))}br.initScrollableAreas(),2==br.bootstrapVersion&&a("ul.dropdown-menu [data-toggle=dropdown]").on("touchstart",function(b){b.preventDefault(),b.stopPropagation(),a(this).closest(".dropdown-menu").find(".dropdown-submenu").removeClass("open"),a(this).parent().addClass("open")})})}(jQuery,window),function(a,b){b.br=b.br||{};var c=[];b.br.onPaste=function(a){c.push(a)},a(document).ready(function(){a("body").on("paste",function(a){function b(a,b){br.events.trigger("paste",a,b);for(var d=0;d<c.length;d++)c[d].call(a,b)}function d(a,c,d,e){var f=new FileReader;f.onload=function(c){var e=/^data[:](.+?)\/(.+?);/.exec(c.target.result),f="other",g="binary";e&&(f=e[1],g=e[2]),a.dataType=f,a.dataSubType=g,a.dataValue=c.target.result,a.data[f]=a.data[f]||{},a.data[f][g]=c.target.result,b(d,a)},f.onerror=function(a){e&&e()},f.readAsDataURL(c)}function e(a,b,c,d){var e=b.getData(c);if(e&&e.length>0){d&&(c="image/url");var f=/^(.+?)\/(.+?)$/.exec(c),g="other",h="binary";return f&&(g=f[1],h=f[2]),a.dataType=g,a.dataSubType=h,a.dataValue=e,d&&(a.data[g]=a.data[g]||{},a.data[g][h]=e),!0}return!1}function f(){if(h.length>0){var b=h.shift();d(g,b,a,function(){f()})}}var g={data:{},dataType:"",dataSubType:"",dataValue:""};a=a.originalEvent;var h=[];if(a.clipboardData){var i;for(i=0;i<a.clipboardData.types.length;i++){var j=a.clipboardData.types[i],k=/^(.+?)\/(.+?)$/.exec(j),l="other",m=j;k&&(l=k[1],m=k[2]),g.data[l]=g.data[l]||{},g.data[l][m]=a.clipboardData.getData(j)}var n=!0;if(e(g,a.clipboardData,"public.url",!0));else if(e(g,a.clipboardData,"text/html"))g.dataValue=g.dataValue.replace(/<(html|body|head|meta|link)[^>]*?>/g,"").replace(/<\/(html|body|head|meta|link)[^>]*?>/g,"");else if(e(g,a.clipboardData,"text/plain"));else{if(a.clipboardData.items&&a.clipboardData.items.length>0)for(i=0;i<a.clipboardData.items.length;i++)a.clipboardData.items[i].type.match("image.*")&&h.push(a.clipboardData.items[i].getAsFile());if(a.clipboardData.files&&a.clipboardData.files.length>0)for(i=0;i<a.clipboardData.files.length;i++)a.clipboardData.files[i].type.match("image.*")&&h.push(a.clipboardData.files[0]);h.length>0&&(n=!1,f())}n&&b(a,g)}})})}(jQuery,window),function(a){function b(a){function b(){for(var a in d){var b=d[a];"added"==b.status&&(b.status="inprogress",f.emit("RMQ/Subscribe",{uid:b.uid,exchange:b.exchange,topic:b.topic}))}}var c=this,d=[],e=1;a=a||{},a.host=a.host||"localhost",a.port=a.port||80,this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)};var f=io.connect(a.host+":"+a.port,{secure:!0});return f.on("connect",function(){c.events.trigger("rmq.log","connected"),c.events.trigger("rmq.connect"),b()}),f.on("disconnect",function(){c.events.trigger("rmq.log","disconnected"),c.events.trigger("rmq.disconnect");for(var a in d)d[a].status="added"}),f.on("error",function(a){c.events.trigger("rmq.log",a),c.events.trigger("rmq.error",a)}),f.on("RMQ/Message",function(a){c.events.trigger("rmq.log",a),c.events.trigger("rmq.message",a),d[a.uid]&&d[a.uid].active&&d[a.uid].callback.call(this,a.data)}),f.on("RMQ/Subscribed",function(a){c.events.trigger("rmq.log","subscribed",a),c.events.trigger("rmq.subscribed",a),d[a.uid]&&(d[a.uid].active=!0)}),this.subscribe=function(a,c,f){var g={uid:e++,exchange:a,topic:c,callback:f,status:"added"};d[g.uid]=g,b()},this.sendMessage=function(a,b,c){f.emit("RMQ/SendMessage",{exchange:a,data:b,topic:c})},this.getSocket=function(){return f},this}var c;a.br=a.br||{},a.br.rabbitMQ=function(a){return c||(c=new b(a)),c}}(window),function(a,b){function c(c,d,e){function f(b){var c=a("input.focus[type!=hidden]:visible,select.focus:visible,textarea.focus:visible",b);if(c.length>0)try{c[0].focus()}catch(d){}else if(c=a("input[type!=hidden]:visible,select:visible,textarea:visible",b),c.length>0)try{c[0].focus()}catch(d){}g.events.trigger("editor.shown")}var g=this,h=null,i=null,j=!1;this.options=e||{},this.options.noun=this.options.noun||"",this.options.selectors=this.options.selectors||{},this.options.selectors.save=this.options.selectors.save||".action-save",this.options.selectors.cancel=this.options.selectors.cancel||".action-cancel",this.options.selectors.errorMessage=this.options.selectors.errorMessage||".editor-error-message",this.container=a(c),this.options.inputsContainer?this.inputsContainer=a(this.options.inputsContainer):this.inputsContainer=this.container,this.dataSource=d,this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)},this.rowid=function(){return h},this.rowData=function(){return i},this.isActive=function(){return g.container.is(":visible")},this.isEditMode=function(){return!br.isNull(h)},this.isInsertMode=function(){return br.isNull(h)},this.lock=function(){a(this.options.selectors.save,g.container).addClass("disabled")},this.unlock=function(){a(this.options.selectors.save,g.container).removeClass("disabled")},this.showError=function(b){var c=a(this.options.selectors.errorMessage,g.container);c.length>0?c.html(b).show():br.growlError(b)},this.editorConfigure=function(a){var b="";g.options.title?b=g.options.title:h?a?b="Copy "+g.options.noun:(b="Edit "+g.options.noun,g.options.hideRowid||(b=b+" (#"+h+")")):b="Create "+g.options.noun,g.container.find(".operation").text(b)};var k;this.init=function(){return g.container.hasClass("modal")&&(g.container.attr("data-backdrop","static"),g.container.on("shown.bs.modal",function(){f(a(this))}),g.container.on("hide.bs.modal",function(){j?j=!1:(k||br.resetCloseConfirmation(),g.events.trigger("editor.cancel",!1,h)),g.events.trigger("editor.hide",!1,h)}),g.container.on("hidden.bs.modal",function(){g.events.trigger("editor.hidden",!1,h)})),a(this.options.selectors.cancel,g.container).removeAttr("data-dismiss"),a(this.options.selectors.cancel,g.container).click(function(){g.cancel()}),a(this.options.selectors.save,g.container).click(function(){a(this).hasClass("disabled")||g.save(a(this).hasClass("action-close")||g.container.hasClass("modal"))}),a(g.inputsContainer).on("click","div.data-field[data-toggle=buttons-radio],input.data-field[type=checkbox],input.data-field[type=radio]",function(){br.confirmClose()}),a(g.inputsContainer).on("change","select.data-field",function(){br.confirmClose()}),a(g.inputsContainer).on("keypress","input.data-field,textarea.data-field",function(){br.confirmClose()}),this},g.fillControls=function(c){if(c)for(var d in c)g.inputsContainer.find("div.data-field[data-toggle=buttons-radio][name="+d+"],input.data-field[name="+d+"],select.data-field[name="+d+"],textarea.data-field[name="+d+"]").each(function(){if("buttons-radio"==a(this).attr("data-toggle")){var b=br.isNull(c[d])?"":c[d];a(this).find('button[value="'+b+'"]').addClass("active")}else if("checkbox"==a(this).attr("type"))1==br.toInt(c[d])?a(this).prop("checked","checked"):a(this).removeAttr("checked");else if("radio"==a(this).attr("type"))br.toInt(c[d])==br.toInt(a(this).val())&&a(this).prop("checked","checked");else{var e=a(this).data("ckeditorInstance");if(e)e.setData(c[d],{noSnapshot:!0});else{var f=a(this).data("BrDataCombo");f?f.val(c[d]):a(this).val(c[d])}}});b.Select2&&g.inputsContainer.find("select.data-field").each(function(){a(this).select2()})},this.show=function(b,c){k=br.isCloseConfirmationRequired(),h=null,i=null;var d=null;br.isNumber(b)?h=b:br.isObject(b)&&(d=b),g.inputsContainer.find("input.data-field[type!=radio],select.data-field,textarea.data-field").val(""),g.inputsContainer.find("input.data-field[type=checkbox]").val("1"),g.inputsContainer.find("input.data-field[type=checkbox]").removeAttr("checked"),g.inputsContainer.find("div.data-field[data-toggle=buttons-radio]").find("button").removeClass("active");var e=a(this.options.selectors.errorMessage,g.container);if(e.length>0&&e.html("").hide(),h){var f={rowid:h},j={disableEvents:!0};g.events.triggerBefore("editor.loadData",f,j),g.dataSource.selectOne(f,function(a,b){a?(i=b,g.events.triggerBefore("editor.show",b,c),g.editorConfigure(c),g.fillControls(b),c&&(h=null),g.events.trigger("editor.show",b,c),br.attachDatePickers(g.inputsContainer),g.container.hasClass("modal")&&g.container.modal("show")):g.container.hasClass("modal")?g.showError(b):br.backToCaller(g.options.returnUrl,!0)},j)}else g.events.triggerBefore("editor.show"),g.editorConfigure(c),g.inputsContainer.find("input.data-field[type=checkbox]").each(function(){a(this).attr("data-default-checked")&&a(this).prop("checked","checked")}),g.fillControls(d),g.events.trigger("editor.show",d),br.attachDatePickers(g.inputsContainer),g.container.hasClass("modal")&&g.container.modal("show");return g.container},this.hide=this.cancel=function(){j=!0,k||br.resetCloseConfirmation(),g.events.trigger("editor.cancel",!1,h),g.container.hasClass("modal")?g.container.modal("hide"):(g.events.trigger("editor.hidden",!1,h),g.events.trigger("editor.hide",!1,h),br.backToCaller(g.options.returnUrl,!1))};var l=!1;return this.save=function(c,d,e){if(l)return void b.setTimeout(function(){g.save(c,d,e)},100);l=!0;try{br.isFunction(c)&&(d=c,e=d,c=!1);var f={},j=[];if(a(this.options.selectors.errorMessage,g.container).hide(),g.events.triggerBefore("editor.save"),g.inputsContainer.find("div.data-field[data-toggle=buttons-radio],input.data-field,select.data-field,textarea.data-field").each(function(){var b,c=!1;if("readonly"!=a(this).attr("readonly")&&"disabled"!=a(this).attr("disabled")&&("buttons-radio"==a(this).attr("data-toggle")?b=a(this).find("button.active").val():"checkbox"==a(this).attr("type")?b=a(this).is(":checked")?1:0:"radio"==a(this).attr("type")?a(this).is(":checked")?b=a(this).val():c=!0:b=a(this).val(),!c))if(!a(this).hasClass("required")||!br.isEmpty(b)||a(this).hasClass("required-edit-only")&&!g.isEditMode()||a(this).hasClass("required-insert-only")&&!g.isInsertMode())br.isEmpty(b)?f[a(this).attr("name")]="":f[a(this).attr("name")]=b;else{var d=a(this).attr("title");br.isEmpty(d)&&(d=a(this).prev("label").text()),0===j.length&&this.focus(),j.push(br.trn("%s must be filled").replace("%s",d)),p=!1}}),j.length>0){var m;m=1==j.length?"{{#errors}}{{.}}{{/errors}}":br.trn("Please check the following:")+"<br /><ul>{{#errors}}<li>{{.}}</li>{{/errors}}</ul>";var n=br.fetch(m,{errors:j});g.showError(n),l=!1}else{var o="",p=!0;o=h?"update":"insert";try{var q={};g.events.trigger("editor.save",o,f,q),h?(g.events.triggerBefore("editor.update",f,q),g.dataSource.update(h,f,function(a,b){try{if(a){if(k||br.resetCloseConfirmation(),g.events.triggerAfter("editor.update",!0,b),g.events.triggerAfter("editor.save",!0,b),c)if(g.container.hasClass("modal"))g.container.modal("hide"),h=null,i=null;else{g.events.trigger("editor.hidden",!0,b);var f={refresh:!0};g.events.trigger("editor.hide",!0,b,f),br.backToCaller(g.options.returnUrl,f.refresh)}else g.options.hideSaveNotification||e||br.growlMessage("Changes saved","Success");d&&d.call(this,b)}else g.dataSource.events.has("error")||g.showError(b)}finally{l=!1}},q)):(g.events.triggerBefore("editor.insert",f,q),g.dataSource.insert(f,function(a,b){try{if(a){if(k||br.resetCloseConfirmation(),h=b.rowid,i=b,g.editorConfigure(!1),g.events.triggerAfter("editor.insert",!0,b),g.events.triggerAfter("editor.save",!0,b),c)if(g.container.hasClass("modal"))g.container.modal("hide"),h=null,i=null;else{g.events.trigger("editor.hidden",!0,b);var f={refresh:!0};g.events.trigger("editor.hide",!0,b,f),br.backToCaller(g.options.returnUrl,f.refresh)}else g.options.hideSaveNotification||e||br.growlMessage("Changes saved","Success");d&&d.call(this,b)}else g.dataSource.events.has("error")||g.showError(b)}finally{l=!1}},q))}catch(r){l=!1,g.showError(r.message)}}}catch(r){throw l=!1,r}},this.init()}b.br=b.br||{},b.br.dataEditor=function(a,b,d){return new c(a,b,d)}}(jQuery,window),function(a,b){function c(c,d){function e(a){return""!==m.options.selectors.container?m.options.selectors.container+" "+a:a}function f(){if(q.length>0){var a=q.shift();m.dataSource.remove(a,function(b,c){b&&m.unSelectRow(a),br.stepProgress(),f()})}else m.dataGrid.isEmpty()&&m.refresh(),br.hideProgress()}function g(a){if(q.length>0){var b=q.shift(),c={};a(c),m.dataSource.update(b,c,function(c,d){c&&m.unSelectRow(b),br.stepProgress(),g(a)})}else br.hideProgress()}function h(a,b,c){if(q.length>0){var d=q.shift();a(d,function(){c.showProgress&&br.stepProgress(),h(a,b,c)})}else c.showProgress&&br.hideProgress(),b&&b()}function i(){t||(a.fn.slider&&(a(e(".pager-page-slider")).each(function(){r=!0,a(this).slider({min:1,value:1,change:function(b,c){var d=a(e(".pager-page-slider")).slider("option","value");if(d>0){var f=m.limit*(d-1);f!=m.skip&&(m.skip=m.limit*(d-1),m.setStored("pager_PageNo",m.skip),m.refresh({},null,!0))}}})}),a(e(".pager-page-size-slider")).each(function(){s=!0,a(this).slider({min:m.defaultLimit,value:m.limit,max:20*m.defaultLimit,step:m.defaultLimit,change:function(b,c){var d=a(e(".pager-page-size-slider")).slider("option","value");m.limit=d,m.setStored("pager_PageSize",m.limit),a(e(".pager-page-slider")).slider("option","value",1),a(e(".pager-page-slider")).slider("option","max",Math.ceil(m.recordsAmount/m.limit)),m.refresh({},null,!0)}})})),t=!0)}function j(){i();var b,c,d,f=Math.ceil(m.recordsAmount/m.limit),g=Math.ceil(m.skip/m.limit)+1;if(r)a(e(".pager-page-slider")).slider("option","max",f),a(e(".pager-page-slider")).slider("option","value",g);else{b=a(e(".pager-page-navigation")),b.html(""),c="";var h=!1,j=!1,k=5,l=!1;for(d=1;d<=f;d++)d<=k||d>g-k&&d<g+k||d>f-k?d==g?c=c+'<strong class="pager-nav-element">'+d+"</strong>":(l=!0,c=c+'<a href="javascript:;" class="pager-action-navigate pager-nav-element" data-page="'+d+'">'+d+"</a>"):!h&&d<g?(c+="...",h=!0):!j&&d>g&&(c+="...",j=!0);l?(b.html(c),a(e(".pager-nav-element")).show()):a(e(".pager-nav-element")).css("display","none")}if(s);else{b=a(e(".pager-page-size-navigation")),b.html(""),c="";var o=m.options.pageSizes;for(d=0;d<o.length;d++){var p=o[d],q=p;if(p>=m.recordsAmount&&(q=m.recordsAmount),c=p==m.limit?c+'<strong class="pager-nav-element">'+q+"</strong>":c+'<a href="javascript:;" class="pager-action-page-size pager-size-element" data-size="'+p+'">'+q+"</a>",p>=m.recordsAmount)break}c.length>0?(b.html(c),a(e(".pager-page-size-container")).show()):a(e(".pager-page-size-container")).css("display","none")}var t=m.skip+1,u=Math.min(m.skip+m.limit,m.recordsAmount);m.recordsAmount>0?(m.recordsAmount>u?(a(e(".action-next")).show(),a(e(".pager-action-next")).show()):(a(e(".action-next")).css("display","none"),a(e(".pager-action-next")).css("display","none")),m.skip>0?(a(e(".action-prior")).show(),a(e(".pager-action-prior")).show()):(a(e(".action-prior")).css("display","none"),a(e(".pager-action-prior")).css("display","none")),a(e(".pager-control")).show(),m.events.triggerAfter("pager.show")):(a(e(".pager-control")).css("display","none"),m.events.triggerAfter("pager.hide")),a(e(".pager-stat")).text("Records "+t+"-"+u+" of "+m.recordsAmount),a(e(".pager-page-size")).text(m.limit+" records per page"),n=!0,m.dataGrid.table&&m.dataGrid.table.update()}function k(){m.dataSource.doingSelect()||m.countDataSource.doingSelect()?(b.clearTimeout(u),u=b.setTimeout(function(){k()},300)):m.countDataSource.selectCount(function(b,c){b?(m.recordsAmount=c,j(),m.events.triggerAfter("recordsCountRetrieved",c)):(a(e(".pager-control")).css("display","none"),m.events.triggerAfter("pager.hide"))})}function l(a,c,d){a?m.dataSource.deferredSelect(c,function(a,b){"function"==typeof d&&d.call(this,a,b)}):m.dataSource.doingSelect()||m.countDataSource.doingSelect()?(b.clearTimeout(v),v=b.setTimeout(function(){l(a,c,d)},300)):m.dataSource.select(c,function(a,b){"function"==typeof d&&d.call(this,a,b)})}var m=this,n=!1;this.options=d||{},this.options.autoLoad=this.options.autoLoad||!1,this.options.defaults=this.options.defaults||{},this.options.defaults.filtersHidden=this.options.defaults.filtersHidden||!1,this.options.entity=c,this.options.features=this.options.features||{editor:!0},this.options.noun=this.options.noun||"",this.options.selectors=this.options.selectors||{},this.options.selectors.container=this.options.selectors.container||"",this.options.selectors.scrollContainer=this.options.selectors.scrollContainer||"",this.options.pageSizes=this.options.pageSizes||[20,50,100,200],this.scrollContainer=function(){return""!==m.options.selectors.container?""!==m.options.selectors.scrollContainer?0===this.options.selectors.scrollContainer.indexOf("#")?m.options.selectors.scrollContainer:m.options.selectors.container+" "+m.options.selectors.scrollContainer:m.options.selectors.container:m.options.selectors.scrollContainer},this.options.selectors.dataTable=e(this.options.selectors.dataTable||".data-table"),this.options.selectors.editForm=this.options.selectors.editForm||"",""===this.options.selectors.editForm&&(""===this.options.selectors.container?this.options.selectors.editForm=".data-edit-form":this.options.selectors.editForm=m.options.selectors.container+" .data-edit-form"),this.options.templates=this.options.templates||{},this.options.templates.row=this.options.templates.row||this.options.templates.rowTemplate||".data-row-template",this.options.templates.groupRow=this.options.templates.groupRow||".data-group-row-template",this.options.templates.noData=this.options.templates.noData||".data-empty-template";var o=e(".action-edit")+","+e(".action-create")+","+e(".action-copy");"string"==typeof c?(this.options.entity.indexOf("/")==-1?this.dataSource=br.dataSource(br.baseUrl+"api/"+this.options.entity+"/"):this.dataSource=br.dataSource(br.baseUrl+this.options.entity),this.dataSource.on("error",function(a,b){br.growlError(b)})):this.dataSource=c,this.storageTag=this.options.storageTag?this.options.storageTag:document.location.pathname+":"+this.dataSource.options.restServiceUrl,this.setStored=function(a,b){br.storage.set(this.storageTag+"stored:"+a,b)},this.getStored=function(a,b){return br.storage.get(this.storageTag+"stored:"+a,b)},this.defaultLimit=this.options.limit||20,this.limit=m.getStored("pager_PageSize",this.defaultLimit),this.skip=0,this.recordsAmount=0,this.selection=br.flagsHolder(),this.countDataSource=br.dataSource(this.dataSource.options.restServiceUrl);var p="body";""!==this.options.selectors.container&&(p=this.options.selectors.container),this.dataGrid=br.dataGrid(this.options.selectors.dataTable,this.options.templates.row,this.dataSource,{templates:{noData:this.options.templates.noData,groupRow:this.options.templates.groupRow},selectors:{header:p,remove:".action-delete",refreshRow:this.options.selectors.refreshRow},appendInInsert:this.options.appendInInsert,defaultOrderAndGroup:this.options.defaultOrderAndGroup,fixedHeader:this.options.fixedHeader,autoHeight:this.options.autoHeight}),this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)},this.before=function(a,b){this.dataSource.before(a,b),this.countDataSource.before(a,b)},this.getOrder=function(){return m.dataGrid.getOrder()},this.isOrderConfigured=function(){return m.dataGrid.isOrderConfigured()},this.setOrder=function(a){m.dataGrid.setOrder(a)},this.setFilter=function(a,b){var c=br.storage.get(this.storageTag+"filter");c=c||{},c[a]=b,br.storage.set(this.storageTag+"filter",c)},this.getFilter=function(a,b){var c=br.storage.get(this.storageTag+"filter",b);return c=c||{},c[a]},this.reloadRow=function(a,b,c){m.dataGrid.reloadRow(a,b,c)},this.hasRow=function(a){return m.dataGrid.hasRow(a)},this.removeRow=function(a){return m.dataGrid.removeRow(a)};var q=[];this.deleteSelection=function(){q=m.selection.get().slice(0),q.length>0?br.confirm("Delete confirmation","Are you sure you want do delete "+q.length+" record(s)?",function(){br.startProgress(q.length,"Deleting..."),f()}):br.growlError("Please select at least one record")},this.updateSelection=function(a){q=m.selection.get().slice(0),q.length>0?(br.startProgress(q.length,"Updating..."),g(a)):br.growlError("Please select at least one record")},this.processSelection=function(a,b,c){c=c||{},c.showProgress=c.showProgress||!1,q=m.selection.get(),q.length>0?(c.showProgress&&br.startProgress(q.length,c.title||""),h(a,b,c)):br.growlError("Please select at least one record")},this.init=function(){function b(){if(a(e(".filters-panel")).is(":visible"))a(e(".action-show-hide-filters")).find("span").text("Hide filters"),a(e(".filter-description")).text("");else{a(e(".action-show-hide-filters")).find("span").text("Show filters");var b="";a(e(".data-filter")).each(function(){var c=a(this).val(),d=a(this).attr("title");c&&d&&(b=b+"/ <strong>"+d+"</strong> ",b=a(this).is("select")?b+a(this).find("option[value="+c+"]").text()+" ":b+c+" ")}),a(e(".filter-description")).html(b)}}function c(c){function d(c){a(e(".filters-panel")).is(":visible")?(m.setStored("filters-hidden",!0),a(e(".filters-panel")).css("display","none"),b(),m.events.trigger("hideFilters")):(m.setStored("filters-hidden",!1),a(e(".filters-panel")).show(),b(),m.events.trigger("showFilters")),m.dataGrid.table&&m.dataGrid.table.update()}a(e(".action-show-hide-filters")).on("click",function(){d()}),a(e(".action-reset-filters")).on("click",function(){m.resetFilters()}),br.isNull(m.getStored("filters-hidden"))&&m.setStored("filters-hidden",m.options.defaults.filtersHidden),m.getStored("filters-hidden")?b():d(c)}function d(){var b=a(m.options.selectors.dataTable).height(),c=a(m.scrollContainer()).height(),d=a(m.scrollContainer()).scrollTop();d+c>b&&m.dataGrid.loadMore()}if(a(".nav-item[rel="+m.options.nav+"]").addClass("active"),m.dataSource.before("select",function(b,c){b=b||{},a(e("input.data-filter[name=keyword]")).length>0&&(b.keyword=a(e("input.data-filter[name=keyword]")).val(),m.setFilter("keyword",b.keyword)),c=c||{},c.skip=m.skip,c.limit=m.limit||m.defaultLimit}),m.dataSource.after("remove",function(a,b){0===q.length&&(m.resetPager(),m.updatePager())}),m.dataSource.after("insert",function(a,b){m.resetPager(),m.updatePager()}),m.countDataSource.before("select",function(b){a(e("input.data-filter[name=keyword]")).length>0&&(b.keyword=a(e("input.data-filter[name=keyword]")).val())}),m.dataSource.after("select",function(a,c){a&&m.options.autoLoad&&(m.skip=m.skip+c.length),m.updatePager(!0),b()}),br.modified(e("input.data-filter[name=keyword]"),function(){var b=a(this).val();a(e("input.data-filter[name=keyword]")).each(function(){a(this).val()!=b&&a(this).val(b)}),a(this).hasClass("instant-search")&&m.refreshDeferred()}),br.modified(e("input.data-filter")+","+e("select.data-filter"),function(){m.resetPager()}),br.attachDatePickers(),m.options.features.editor){var f=m.options.editor||{noun:m.options.noun};m.editor=br.dataEditor(m.options.selectors.editForm,m.dataSource,f),m.editor.events.connectTo(m.events),a(e(".action-create")).show(),a(document).on("click",o,function(){var b=a(this).hasClass("action-copy"),c=a(this).closest("[data-rowid]").attr("data-rowid");m.editor.show(c,b)})}return a(e("a.action-next")+","+e("a.pager-action-next")).on("click",function(){m.skip+=m.limit,m.refresh({},null,!0)}),a(e("a.action-prior")+","+e("a.pager-action-prior")).on("click",function(){m.skip-=m.limit,m.skip<0&&(m.skip=0),m.refresh({},null,!0)}),a(e(".pager-page-navigation")).on("click","a.pager-action-navigate",function(){var b=br.toInt(a(this).attr("data-page"));if(b>0){var c=m.limit*(b-1);c!=m.skip&&(m.skip=m.limit*(b-1),m.setStored("pager_PageNo",m.skip),m.refresh({},null,!0))}}),a(e(".pager-page-size-navigation")).on("click","a.pager-action-page-size",function(){var b=br.toInt(a(this).attr("data-size"));m.limit=b,m.setStored("pager_PageSize",m.limit),m.refresh({},null,!0)}),a(e(".action-refresh")).click(function(){m.refresh()}),a(e(".action-clear-one-filter")).click(function(){a(e(".data-filter[name="+a(this).attr("rel")+"]")).val(""),m.refresh()}),a(e("input.data-filter[name=keyword]")).val(m.getFilter("keyword")),c(!0),m.options.autoLoad&&a(m.scrollContainer()).on("scroll",function(){d()}),a(document).on("click",e(".action-select-all"),function(){var b=a(this).is(":checked");m.selectAll(b)}),a(document).on("click",e(".action-select-row"),function(){var b=a(this).closest("[data-rowid]"),c=b.attr("data-rowid"),d=a(this).is(":checked");d?m.selectRow(c):m.unSelectRow(c)}),a(document).on("click",e(".action-clear-selection"),function(){m.clearSelection()}),a(document).on("click",e(".action-delete-selected"),function(){m.deleteSelection()}),m.dataGrid.before("changeOrder",function(){m.resetPager()}),m.dataGrid.on("change",function(){a(e(".action-select-all")).removeAttr("checked");var b=m.selection.get();b.length>0?m.restoreSelection():m.clearSelection(),m.events.trigger("change"),m.events.triggerAfter("change")}),m.events.on("selectionChanged",function(){var b=m.selection.get();b.length>0?(a(e(".selection-stat")).text(b.length+" record(s) selected"),a(e(".selection-stat")).show(),a(e(".action-clear-selection")).show()):(a(e(".selection-stat")).css("display","none"),a(e(".action-clear-selection")).css("display","none"))}),this};var r=!1,s=!1,t=!1;this.restoreSelection=function(a){a||(a=m.selection.get());for(var b=0;b<a.length;b++)m.selectRow(a[b],!0);m.events.trigger("selectionChanged")},this.clearSelection=function(){m.selection.clear(),a(e(".action-select-row")).removeAttr("checked"),a(e("tr.row-selected")).removeClass("row-selected"),a(e(".action-select-all")).removeAttr("checked"),m.events.trigger("selectionChanged")},this.getSelection=function(){return m.selection.get()};var u;this.updatePager=function(a){!n||a?(b.clearTimeout(u),u=b.setTimeout(function(){k()},300)):j()};var v;return this.unSelectRow=function(b,c){var d,e=a(m.options.selectors.dataTable).find("input.action-select-row[value="+b+"]");d=e.length>0?a(e).closest("[data-rowid]"):a(m.options.selectors.dataTable).find("tr[data-rowid="+b+"]"),d.length>0&&(d.find(".action-select-row").removeAttr("checked"),d.removeClass("row-selected")),m.selection.remove(b),c||m.events.trigger("selectionChanged")},this.selectRow=function(b,c){var d,e=a(m.options.selectors.dataTable).find("input.action-select-row[value="+b+"]");d=e.length>0?a(e).closest("[data-rowid]"):a(m.options.selectors.dataTable).find("tr[data-rowid="+b+"]"),d.length>0&&(d.find(".action-select-row").prop("checked","checked"),d.addClass("row-selected"),m.selection.append(b),c||m.events.trigger("selectionChanged"))},this.selectAll=function(b){b?a(e(".action-select-all")).prop("checked","checked"):a(e(".action-select-all")).removeAttr("checked"),a(e(".action-select-row")).each(function(){var c=a(this).closest("[data-rowid]"),d=c.attr("data-rowid");b?m.selectRow(d,!0):m.unSelectRow(d,!0)}),m.events.trigger("selectionChanged")},this.isFiltersVisible=function(){return a(e(".filters-panel")).is(":visible")},this.resetPager=function(){n=!1,m.skip=0},this.resetFilters=function(){a(e("input.data-filter")).val(""),a(e("select.data-filter")).val(""),a(e("select.data-filter")).trigger("reset"),br.storage.remove(this.storageTag+"filter"),m.events.trigger("resetFilters"),br.refresh()},this.refreshDeferred=function(a,b,c){"function"==typeof a&&(c=b,b=a,a={}),c||m.resetPager(),l(!0,a,b)},this.refresh=function(a,b,c){"function"==typeof a&&(c=b,b=a,a={}),c||m.resetPager(),l(!1,a,b)},this.init()}b.br=b.br||{},b.br.dataBrowser=function(a,b){return new c(a,b)}}(jQuery,window),function(a,b){function c(c,d,e,f,g,h,i){var j='<li><a class="br-ex-action-change-menu" href="javascript:;" data-value="{{id}}">{{name}}</a></li>',k=a('<div class="dropdown br-ajax-dropdown" style="position:absolute;z-index:1050;"><a style="display:none;" href="javascript:;" role="button" data-toggle="dropdown" class="dropdown-toggle br-ex-action-change-menu-menu" style="cursor:pointer;"><span>{{value}}</span> <b class="caret"></b></a><ul class="dropdown-menu" role="menu" style="overflow:auto;"></ul></div>'),l=k.find("ul"),m=k.find(".br-ex-action-change-menu-menu");k.on("click",".br-ex-action-change-menu",function(){var b=a(this).attr("data-value"),d={};d[h]=b,i.onClick?i.onClick.call(a(this),g,e,d,f):g.update(e,d,function(a,b){a&&i.onUpdate&&i.onUpdate.call(c,b,f)})}),a(document).on("click.dropdown.data-api",function(){k.remove()}),l.html(""),i.allowClear&&l.append(br.fetch(j,{id:"",name:i.clearLabel?i.clearLabel:"--Clear--"})),i.onBeforeRenderMenu&&i.onBeforeRenderMenu.call(l,j);for(var n in d)l.append(br.fetch(j,{id:d[n][i.keyField],name:d[n][i.nameField]}));k.css("left",c.offset().left+"px");var o=c.find(".br-ex-action-change-menu-menu"),p=o.offset().top+o.height(),q=a(b).scrollTop();k.css("top",p+"px"),p-=q;var r=Math.max(a(b).height()-p-20,100);l.css("max-height",r+"px"),a("body").append(k),m.dropdown("toggle")}function d(b,d,e,f,g,h){var i=b.closest("[data-rowid]").attr("data-rowid"),j=d.find("span.br-ex-current-value"),k={__targetRowid:i};h.onSelect&&h.onSelect.call(e,k,i,a(b)),e.select(k,function(a,b){a&&b.length>0&&c(d,b,i,j,f,g,h)})}function e(b,c,e,f,h,i){var j=b;if(j.data("BrExChangeMenu"));else{j.data("BrExChangeMenu",!0);var k=j.text().trim();0!==k.length&&"(click to change)"!=k||(k='<span style="color:#AAA;">(click to change)</span>');var l=a(br.fetch(g,{value:k}));i.onSetupInvoker&&i.onSetupInvoker.call(l),j.html(l),j.on("click",".br-ex-action-change-menu-menu",function(){d(a(this),j,e,f,h,i)}),c&&d(j.find(".br-ex-action-change-menu-menu"),j,e,f,h,i)}}function f(b,c,d,f,g){g=g||{},g.keyField=g.keyField||"id",g.nameField=g.nameField||"name",a(b).each(function(){e(a(this),!1,c,d,f,g)}),a(document).on("click",b,function(){e(a(this),!0,c,d,f,g)})}var g='<div class="dropdown br-ajax-dropdown"><span href="javascript:;" class="br-ex-action-change-menu-menu" style="cursor:pointer;"><span class="br-ex-current-value">{{&value}}</span> <b class="caret"></b></a></div>';b.br=b.br||{},b.br.exChangeMenu=function(a,b,c,d,e){return new f(a,b,c,d,e)}}(jQuery,window);