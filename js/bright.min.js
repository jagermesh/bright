/* jshint ignore:start */ /*! bright 26-09-2016 */
!function(a){a.br=a.br||{},a.br.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a.br.isNull=function(a){return void 0===a||null===a},a.br.isEmpty=function(a){return br.isNull(a)||"undefined"!=typeof a.length&&0===a.length},a.br.isArray=function(a){return!br.isNull(a)&&"[object Array]"===Object.prototype.toString.call(a)},a.br.isObject=function(a){return!br.isEmpty(a)&&"object"==typeof a},a.br.isEmptyObject=function(a){if(br.isObject(a)){var b=!0;for(var c in a){b=!1;break}return b}return!1},a.br.isBoolean=function(a){return"boolean"==typeof a},a.br.isString=function(a){return"string"==typeof a},a.br.isFunction=function(a){return"function"==typeof a},a.br.toString=function(a){return br.isNull(a)?"":a.toString()},a.br.split=function(a,b){return br.isEmpty(a)?[]:br.isString(a)?a.split(b):void 0},a.br.toInt=function(a){if(br.isString(a)){if(a.length>0)return parseInt(a,10)}else if(br.isNumber(a))return a},a.br.toReal=function(a){return br.isString(a)?a.length>0?parseFloat(a):0:br.isNumber(a)?a:0}}(window),function(a){function b(a){function b(a,b,c){var d=null,e=f.get(a,b);return br.isArray(e)&&e.length>0&&(d=e.pop(),c&&f.set(a,e)),br.isEmpty(d)?br.isNull(b)?d:b:d}function d(a,b,c){var d=null,e=f.get(a,b);return br.isArray(e)&&e.length>0&&(d=e.shift(),c&&f.set(a,e)),br.isEmpty(d)?br.isEmpty(b)?d:b:d}var e=a,f=this;this.get=function(a,b){var d;if(br.isArray(a)){d={};for(var f in a)d[a[f]]=this.get(a[f])}else d=c.unpack(e.getItem(a));return br.isEmpty(d)?br.isNull(b)?d:b:d},this.set=function(a,b){if(br.isObject(a))for(var d in a)this.set(d,a[d]);else e.setItem(a,c.pack(b));return this},this.inc=function(a,b,c){var d=this.get(a);return br.isNumber(d)?(b=br.isNumber(b)?b:1,this.set(a,d+b)):br.isString(d)?br.isEmpty(b)||(void 0===c&&(c=", "),d=br.isEmpty(d)?b:d+c+b,this.set(a,d)):(b=br.isNumber(b)?b:1,this.set(a,b)),this},this.dec=function(a,b){var c=this.get(a);return b=br.isNumber(b)?b:1,this.set(a,br.isNumber(c)?c-b:b),this},this.append=function(a,b,c){if(!br.isEmpty(b)){var d=this.get(a);if(br.isArray(d)||(d=[]),br.isArray(b))for(var e in b)this.append(a,b[e],c);else{if(br.isNumber(c))for(;d.length>=c;)d.shift();d.push(b),this.set(a,d)}}return this},this.appendUnique=function(a,b,c){return br.isEmpty(b)||(this.remove(a,b),this.append(a,b,c)),this},this.prepend=function(a,b,c){if(!br.isEmpty(b)){var d=this.get(a);if(br.isArray(d)||(d=[]),br.isArray(b))for(var e in b)this.prepend(a,b[e],c);else{if(br.isNumber(c))for(;d.length>=c;)d.pop();d.unshift(b),this.set(a,d)}}return this},this.prependUnique=function(a,b,c){return br.isEmpty(b)||(this.remove(a,b),this.prepend(a,b,c)),this},this.each=function(a,b){var c=this.get(a);br.isArray(c)||(c=[]);for(var d=0;d<c.length;d++)b.call(this,c[d]);return this},this.getLast=function(a,c){return b(a,c,!1)},this.takeLast=function(a,c){return b(a,c,!0)},this.getFirst=function(a,b){return d(a,b,!1)},this.takeFirst=function(a,b){return d(a,b,!0)},this.extend=function(a,b){if(!br.isEmpty(b)){var c=this.get(a);if(br.isObject(c)||(c={}),br.isObject(b)){for(var d in b)c[d]=b[d];this.set(a,c)}}return this},this.not=function(a){var b=this.get(a);return br.isBoolean(b)||(b=!1),this.set(a,!b),this},this.clear=function(){return e.clear(),this},this.all=function(){var a={};for(var b in e)a[b]=this.get(b);return a},this.remove=function(a,b){var c=this.get(a);if(!br.isEmpty(b)&&br.isArray(c)){var d=c.indexOf(b);-1!=d&&c.splice(d,1),this.set(a,c)}else e.removeItem(a);return this},this.indexOf=function(a,b){var c=this.get(a);return br.isArray(c)?c.indexOf(b):-1}}var c={pack:function(a){return JSON.stringify(a)},unpack:function(a){try{return JSON.parse(a)}catch(b){return null}}};a.br=a.br||{},a.br.storage=new b(a.localStorage),a.br.session=new b(a.sessionStorage)}(window),function(a){function b(a){function b(a,b,d){var e,f=null,g=c.subscribers[a];if(g)switch(b){case"before":for(e=0;e<g.before.length;e++)g.before[e].apply(c.obj,d);break;case"on":for(e=0;e<g.on.length;e++)f=g.on[e].apply(c.obj,d);break;case"after":for(e=0;e<g.after.length;e++)g.after[e].apply(c.obj,d)}return f}var c=this;this.subscribers={},this.connections=[],this.obj=a||this,this.before=function(a,b){a=a.split(",");for(var d=0;d<a.length;d++)c.subscribers[a[d]]=c.subscribers[a[d]]||{on:[],before:[],after:[]},c.subscribers[a[d]].before.push(b)},this.on=function(a,b){a=a.split(",");for(var d=0;d<a.length;d++)c.subscribers[a[d]]=c.subscribers[a[d]]||{on:[],before:[],after:[]},c.subscribers[a[d]].on.push(b)},this.after=function(a,b){a=a.split(",");for(var d=0;d<a.length;d++)c.subscribers[a[d]]=c.subscribers[a[d]]||{on:[],before:[],after:[]},c.subscribers[a[d]].after.push(b)},this.has=function(a){return c.subscribers.hasOwnProperty(a)},this.connectTo=function(a){c.connections.push(a)},this.triggerEx=function(a,d,e){var f,g=[];for(f=0;f<e.length;f++)g.push(e[f]);"*"!=a&&b("*",d,g),g.splice(0,1);var h=b(a,d,g);for(f=0;f<c.connections.length;f++)c.connections[f].triggerEx(a,d,e);return h},this.triggerBefore=function(a){return this.triggerEx(a,"before",arguments)},this.trigger=function(a){return this.triggerEx(a,"on",arguments)},this.triggerAfter=function(a){return this.triggerEx(a,"after",arguments)}}a.br=a.br||{},a.br.eventQueue=function(a){return new b(a)}}(window),function(a){function b(){this.continueRoute=!0,this.get=function(b,c){var d,e=document.location.search.replace("?","").split("&"),f={};for(d=0;d<e.length;d++){var g=e[d].split("=");if(-1!=g[0].indexOf("[")){var h=g[0].substr(0,g[0].indexOf("["));f[h]=f[h]||[],f[h].push(a.unescape(g[1]))}else f[g[0]]=a.unescape(g[1])}if(b){for(d in f)if(d==b)return f[d];return c}return f},this.anchor=function(b){var c=document.location.hash.replace("#","");return c?(0===c.length&&(c=b),c=a.unescape(c)):c=b,c},this.route=function(a,b){if(this.continueRoute){var c=document.location.toString();c=c.replace(/[?].*/,""),-1!=c.search(a)&&(this.continueRoute=!1,b.call())}return this}}a.br=a.br||{},a.br.request=new b}(window),function(a){function b(a){var b=this;b.queue=[],b.workingQueue=[],b.lazy=a,this.push=function(a){b.queue.unshift({func:a}),b.lazy||b.wakeup()},this.done=function(a){b.workingQueue.pop(),b.wakeup()},this.clear=function(a){b.queue=[],b.workingQueue=[]},this.wakeup=function(){if(b.queue.length>0&&0===b.workingQueue.length){var a=b.queue.pop();b.workingQueue.push(a),a.func(function(){b.done()})}}}a.br=a.br||{},a.br.thread=function(a){return new b(a)};br.thread(!0)}(window),function(a,b){function c(){var a=[];return this.get=function(b){return a[b]?a[b]:b},this.set=function(b,c){return a[b]=c,this},this}function d(a,c){var d="BrModified_Callbacks2",e="BrModified_LastCahange2";if(c&&(b.clearTimeout(a.data("BrModified_Timeout")),d="BrModified_Callbacks1",e="BrModified_LastCahange1"),a.data(e)!=a.val()){a.data(e,a.val());var f=a.data(d);if(f)for(var g in f)f[g].call(a)}}function e(a){d(a,!1),a.data("BrModified_Callbacks1")&&(b.clearTimeout(a.data("BrModified_Timeout")),a.data("BrModified_Timeout",b.setTimeout(function(){d(a,!0)},1500)))}function f(b,c,f){a(b).each(function(){a(this).data("br-data-change-callbacks")||a(this).data("br-data-change-callbacks",[]);var b="BrModified_Callbacks2";f&&(b="BrModified_Callbacks1");var d=a(this).data(b);d||(d=[]),d.push(c),a(this).data(b,d)}),a(document).on("change",b,function(){e(a(this))}),a(document).on("keyup",b,function(b){13==b.keyCode?(d(a(this),!1),d(a(this),!0)):(8==b.keyCode||32==b.keyCode||91==b.keyCode||93==b.keyCode||b.keyCode>=48&&b.keyCode<=90||b.keyCode>=96&&b.keyCode<=111||b.keyCode>=186&&b.keyCode<=222)&&e(a(this))})}function g(){return l?br.closeConfirmationMessage:void(m=!0)}b.br=b.br||{};var h="",i=["vendor/jagermesh/bright/js/bright.min.js","vendor/jagermesh/bright/js/bright.js","bright/js/bright.min.js","bright/js/bright.js"];"undefined"==typeof b.br.frameworkUrl||i.push(b.br.frameworkUrl),a("script").each(function(){if(""===h){var b=a(this).attr("src");if(!br.isEmpty(b))for(var c in i){var d=b.indexOf(i[c]);-1!=d&&(h=b.substring(0,d))}}}),b.br.baseUrl=h;var j=!1;b.br.log=function(a){if("undefined"!=typeof console){j||(console.log("*********************** LOG STARTED ***********************"),j=!0);for(var b in arguments)console.log(arguments[b])}},b.br.isTouchScreen=function(){var a=navigator.userAgent;return/iPad/i.test(a)||/iPhone/i.test(a)||/Android/i.test(a)},b.br.isMobileDevice=function(){var a=navigator.userAgent;return/iPad/i.test(a)||/iPhone/i.test(a)||/Android/i.test(a)},b.br.isiOS=function(){var a=navigator.userAgent;return/iPad/i.test(a)||/iPhone/i.test(a)},b.br.isiPad=function(){var a=navigator.userAgent;return/iPad/i.test(a)},b.br.isiPhone=function(){var a=navigator.userAgent;return/iPhone/i.test(a)},b.br.isAndroid=function(){var a=navigator.userAgent;return/android/i.test(a)},b.br.isIE=function(){return!!document.documentMode},b.br.isOpera=function(){return!!b.opera||navigator.userAgent.indexOf(" OPR/")>=0},b.br.isFirefox=function(){return"undefined"!=typeof InstallTrigger},b.br.isSafari=function(){return-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")},b.br.isChrome=function(){return!!b.chrome&&!br.isOpera()},b.br.redirect=function(a){-1==a.search(/^\//)&&-1==a.search(/^http[s]?:\/\//)&&(a=this.baseUrl+a),document.location=a},b.br.refresh=function(){document.location.reload()};var k=new c;b.br.trn=function(a){return a?k.get(a):k},b.br.preloadImages=function(a){try{var b=document.createElement("div"),c=b.style;c.position="absolute",c.top=c.left=0,c.visibility="hidden",document.body.appendChild(b),b.innerHTML='<img src="'+a.join('" /><img src="')+'" />'}catch(d){}},b.br.randomInt=function(a,b){return void 0===b&&(b=a,a=0),Math.floor(Math.random()*(b-a+1))+a},b.br.forHtml=function(a){return a&&(a=a.split("<").join("&lt;").split(">").join("&gt;")),a},b.br.extend=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype},b.br.openLinkPopup=function(b){var c='<div class="modal modal-autosize" ';2==br.bootstrapVersion&&(c+=' style="top:20px;margin-top:0px;"');var d=b;-1===b.indexOf("www.")&&-1===b.indexOf("http")&&(d=""+document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:""),0!==b.indexOf("/")&&(d+="/"),d+=b),c+='><div class="modal-dialog"><div class="modal-content">',c=c+'<div class="modal-body" style="overflow-y:auto;"><p>You browser is currently blocking popups</p><p>Click the link below to open this manually:</p><p><a style="color: #08c;" target="_blank" class="open-link-popup-link" href="'+b+'">'+d+'</a></p><p>To eliminate this extra step, we recommend you modify your settings to disable the popup blocker.</p></div><div class="modal-footer"><a href="javascript:;" class="btn btn-sm btn-default" data-dismiss="modal">&nbsp;'+br.trn("Dismiss")+"&nbsp;</a></div></div></div></div>";var e=a(c);a(e).on("hide.bs.modal",function(){e.remove()}),a(e).modal("show"),a(e).find(".open-link-popup-link").on("click",function(){a(e).modal("hide"),e.remove()}),br.enchanceBootstrap(e),br.resizeModalPopup(e)},b.br.openPage=function(a){if("undefined"==typeof b.popupBlocked)if(b.br.isSafari()){var c=b.open("about:blank","","directories=no,height=100,width=100,menubar=no,resizable=no,scrollbars=no,status=no,titlebar=no,top=0,location=no");c?(b.popupBlocked=!1,c.close()):b.popupBlocked=!0}else b.popupBlocked=!1;if(b.popupBlocked)b.br.openLinkPopup(a);else{var d=document.createElement("a");d.href=a,d.target="_blank",document.body.appendChild(d),d.click(),d.remove()}},b.br.openPopup=function(a,c){c||(c="_blank");var d,e;screen.width&&(d=screen.width>=1280?1e3:screen.width>=1024?800:600),screen.height&&(e=screen.height>=900?700:screen.height>=800?600:500);var f=screen.width?(screen.width-d)/2:0,g="height="+e+",width="+d+",top=20,left="+f+",menubar=0,scrollbars=1,resizable=1",h=b.open(a,c,g);h?h.focus():b.br.isSafari()&&b.br.openLinkPopup(a)},b.br.modifiedDeferred=function(a,b){f(a,b,!0)},b.br.modified=function(a,b){f(a,b,!1)},b.br.onChange=function(b,c){a(b).on("change",function(){c.call(this)}),a(b).on("keyup",function(a){13==a.keyCode?c.call(this):(8==a.keyCode||32==a.keyCode||91==a.keyCode||93==a.keyCode||a.keyCode>=48&&a.keyCode<=90||a.keyCode>=96&&a.keyCode<=111||a.keyCode>=186&&a.keyCode<=222)&&c.call(this)})},b.br.closeConfirmationMessage="Some changes have been made. Are you sure you want to close current window?";var l=!1,m=!1;a(b).on("beforeunload",function(){return g()}),b.br.isUnloading=function(a){return"undefined"==typeof a?m:void(m=a)},b.br.isCloseConfirmationRequired=function(){return l},b.br.confirmClose=function(a){a&&(br.closeConfirmationMessage=a),l=!0,br.events.trigger("closeConfirmationRequested")},b.br.resetCloseConfirmation=function(a){l=!1,br.events.trigger("closeConfirmationReset")},b.br.events=br.eventQueue(),b.br.backToCaller=function(a,c){var d=null!==b.opener;if(d){if(b.opener&&!b.opener.closed){b.opener.focus();try{c&&b.opener.document&&b.opener.document.location.reload()}catch(e){}}b.close()}else br.request.get("caller")?document.location=br.request.get("caller"):document.location=a},b.br.disableBounce=function(c){function d(){var c=a(b).height();e.css("height",c+"px"),e.css("overflow","auto")}var e=c;a("body").css("overflow","hidden"),d(),a(b).resize(function(){d()})},b.br.getSelection=function(){var a="";if("undefined"!=typeof b.getSelection){var c=b.getSelection();if(c.rangeCount){for(var d=document.createElement("div"),e=0,f=c.rangeCount;f>e;++e)d.appendChild(c.getRangeAt(e).cloneContents());a=d.innerHTML}}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(a=document.selection.createRange().htmlText);return a};var n;b.br.beep=function(a){try{var c=.1;b.AudioContext=b.AudioContext||b.webkitAudioContext,n||(n=new AudioContext);var d=n.createOscillator();d.type=0,d.connect(n.destination);var e=n.currentTime;d.start?(d.start(e),d.stop(e+c)):(d.noteOn(e),d.noteOff(e+c)),d.onended=function(){a&&a()}}catch(f){br.log(f)}},b.br["do"]=function(a){a.call()},b.br.load=b.br.resourceLoader=function(a){function b(b,c){var d,e=a.createElement(b);for(d in c)c.hasOwnProperty(d)&&e.setAttribute(d,c[d]);return e}function c(a){var b,c,d=i[a];d&&(b=d.callback,c=d.urls,c.shift(),j=0,c.length||(b&&b.call(d.context,d.obj),i[a]=null,k[a].length&&e(a)))}function d(){if(!g){var b=navigator.userAgent;g={async:a.createElement("script").async===!0},(g.webkit=/AppleWebKit\//.test(b))||(g.ie=/MSIE/.test(b))||(g.opera=/Opera/.test(b))||(g.gecko=/Gecko\//.test(b))||(g.unknown=!0)}}function e(e,j,l,m,n){var o,p,q,r,s=function(){c(e)},t="css"===e;if(d(),j)if(j="string"==typeof j?[j]:j.concat(),t||g.async||g.gecko||g.opera)k[e].push({urls:j,callback:l,obj:m,context:n});else for(o=0,p=j.length;p>o;++o)k[e].push({urls:[j[o]],callback:o===p-1?l:null,obj:m,context:n});if(!i[e]&&(r=i[e]=k[e].shift()))for(h||(h=a.head||a.getElementsByTagName("head")[0]),j=r.urls,o=0,p=j.length;p>o;++o)l=j[o],t?q=g.gecko?b("style"):b("link",{href:l,rel:"stylesheet"}):(q=b("script",{src:l}),q.async=!1),q.className="lazyload",q.setAttribute("charset","utf-8"),g.ie&&!t?q.onreadystatechange=function(){/loaded|complete/.test(q.readyState)&&(q.onreadystatechange=null,s())}:t&&(g.gecko||g.webkit)?g.webkit?(r.urls[o]=q.href,f()):(q.innerHTML='@import "'+l+'";',c("css")):q.onload=q.onerror=s,h.appendChild(q)}function f(){var a,b=i.css;if(b){for(a=l.length;--a>=0;)if(l[a].href===b.urls[0]){c("css");break}j+=1,b&&(200>j?setTimeout(f,50):c("css"))}}var g,h,i={},j=0,k={css:[],js:[]},l=a.styleSheets;return{css:function(a,b,c,d){e("css",a,b,c,d)},js:function(a,b,c,d){e("js",a,b,c,d)}}}(document)}(jQuery,window),function(a){function b(a,b){var c=[];this.append=function(d){a?br.storage.appendUnique(b,d):this.isFlagged(d)||c.push(d)},this.isFlagged=function(d){return a?-1!=br.storage.indexOf(b,d):-1!=c.indexOf(d)},this.remove=function(d){if(a)br.storage.remove(b,d);else{var e=c.indexOf(d);-1!=e&&c.splice(e,1)}},this.clear=function(){this.replace([])},this.replace=function(d){return a?br.storage.set(b,d):c=d},this.get=function(){return a?br.storage.get(b,[]):c}}a.br=a.br||{},a.br.flagsHolder=function(a,c){return new b(a,c)}}(window),function(a,b){function c(c,d){function e(a,b,c,d){d=d||{};var e=d&&d.disableEvents;d&&d.selectOne;e||(g.events.trigger("error","select",a),g.events.triggerAfter("select",!1,a,b)),"function"==typeof c&&c.call(g,!1,a,b)}function f(a,b,c,d){d=d||{};var f=d&&d.disableEvents,h=d&&d.selectCount,i=d&&(d.selectOne||d.selectCount);if(i&&br.isArray(a)){if(!(a.length>0))return void e("Record not found",b,c,d);a=a[0]}else i||br.isArray(a)||(a=[a]);h&&(a=parseInt(a)),f||(g.events.trigger("select",a),g.events.triggerAfter("select",!0,a,b)),"function"==typeof c&&c.call(g,!0,a,b)}var g=this;this.ajaxRequest=null,this.name="-",this.options=d||{},this.options.restServiceUrl=c,this.options.refreshDelay=this.options.refreshDelay||1500,"/"!=this.options.restServiceUrl.charAt(this.options.restServiceUrl.length-1)&&(this.options.restServiceUrl=this.options.restServiceUrl+"/"),this.options.offlineMode&&(this.db=TAFFY(),this.db.store("taffy-db-"+this.name)),this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)},this.insert=function(b,c,d){function e(a){var b;g.options.crossdomain?"string"==typeof a?(b=!1,g.events.trigger("error","insert",a.length>0?a:"Empty response. Was expecting new created records with ROWID.")):(b=!0,f||g.events.trigger("insert",a)):a?(b=!0,f||g.events.trigger("insert",a)):(b=!1,g.events.trigger("error","insert","Empty response. Was expecting new created records with ROWID.")),f||(g.events.triggerAfter("insert",b,a,h),b&&g.events.trigger("change","insert",a)),"function"==typeof c&&c.call(g,b,a,h)}var f=d&&d.disableEvents,h=b;try{g.events.triggerBefore("insert",h),this.options.crossdomain&&(h.crossdomain="put"),g.options.offlineMode?(g.db.insert(h),h.rowid=h.___id,h.syncState="n",e(h)):a.ajax({type:this.options.crossdomain?"GET":"PUT",data:h,dataType:this.options.crossdomain?"jsonp":"json",url:this.options.restServiceUrl+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){e(a)},error:function(a,b,d){if(br.isUnloading());else{var e=br.isEmpty(a.responseText)?a.statusText:a.responseText;f||(g.events.trigger("error","insert",e),g.events.triggerAfter("insert",!1,e,h)),"function"==typeof c&&c.call(g,!1,e,h)}}})}catch(i){br.log(i),f||(g.events.trigger("error","insert",i),g.events.triggerAfter("insert",!1,i,h)),"function"==typeof c&&c.call(g,!1,i,h)}return this},this.update=function(b,c,d,e){function f(a){var e="update";if(a){var f=g.events.trigger("removeAfterUpdate",c,a);null!==f&&f?(e="remove",h||g.events.trigger("remove",b)):h||g.events.trigger("update",a,b)}h||(g.events.triggerAfter(e,!0,a,i),g.events.trigger("change",e,a)),"function"==typeof d&&d.call(g,!0,a,i)}var h=e&&e.disableEvents,i=c;return h||g.events.triggerBefore("update",i,b),g.options.offlineMode?(g.db({rowid:b}).update(i),f(i)):a.ajax({type:"POST",data:i,dataType:"json",url:this.options.restServiceUrl+b+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){f(a)},error:function(a,b,c){if(br.isUnloading());else{var e=br.isEmpty(a.responseText)?a.statusText:a.responseText;h||(g.events.trigger("error","update",e),g.events.triggerAfter("update",!1,e,i)),"function"==typeof d&&d.call(g,!1,e,i)}}}),this},this.remove=function(b,c){function d(a){g.events.trigger("remove",b),g.events.triggerAfter("remove",!0,a,e),g.events.trigger("change","remove",a),"function"==typeof c&&c.call(g,!0,a,e)}var e={};if(g.events.triggerBefore("remove",null,b),g.options.offlineMode){var f=g.db({rowid:b}).get();g.db({rowid:b}).remove(),d(f)}else a.ajax({type:"DELETE",data:e,dataType:"json",url:this.options.restServiceUrl+b+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){d(a)},error:function(a,b,d){if(br.isUnloading());else{var f=br.isEmpty(a.responseText)?a.statusText:a.responseText;g.events.trigger("error","remove",f),g.events.triggerAfter("remove",!1,f,e),"function"==typeof c&&c.call(g,!1,f,e)}}});return this},this.selectCount=function(a,b,c){"function"==typeof a&&(c=b,b=a);var d={};for(var e in a)d[e]=a[e];return d.__result="count",c=c||{},c.selectCount=!0,this.select(d,b,c),this},this.selectOne=function(a,b,c){return br.isFunction(a)&&(c=b,b=a,a={}),c=c||{},c.selectOne=!0,c.limit=1,br.isEmpty(a)?this.select(a,b,c):br.isNumber(a)||br.isObject(a)?br.isNumber(a)?this.select({rowid:a},b,c):this.select(a,b,c):(e("Unacceptable filter parameters",a,b,c),this)},this.select=function(b,c,d){var h,i={};br.isFunction(b)&&(d=c,c=b,b={}),d=d||{};var j=d&&d.disableEvents,k=d&&d.selectOne;if(k&&(d.limit=1),!br.isEmpty(b)){if(!br.isNumber(b)&&!br.isObject(b))return e("Unacceptable filter parameters",b,c,d),this;br.isNumber(b)&&(b={rowid:b});for(var l in b)"rowid"==l&&k?h=b[l]:i[l]=b[l]}var m=this.options.restServiceUrl;k&&h&&(m+=h);var n=!0;if(!j)try{g.events.triggerBefore("select",i,d)}catch(o){br.log(o),n=!1}return n&&(br.isEmpty(this.options.limit)||(i.__limit=this.options.limit),d&&!br.isEmpty(d.skip)&&(i.__skip=d.skip),d&&!br.isEmpty(d.limit)&&(i.__limit=d.limit),d&&d.fields&&(i.__fields=d.fields),d&&d.dataSets&&(i.__dataSets=d.dataSets),d&&d.renderMode&&(i.__renderMode=d.renderMode),d&&d.order&&(i.__order=d.order),d&&d.page&&(i.__page=d.page),this.options.crossdomain&&(i.crossdomain="get"),g.options.offlineMode?f(g.db(i).get(),i,c,d):this.ajaxRequest=a.ajax({type:"GET",data:i,dataType:this.options.crossdomain?"jsonp":"json",url:m+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){g.ajaxRequest=null,g.options.crossdomain&&"string"==typeof a?e("Unknown error",i,c,d):br.isNull(a)?e("Unknown error",i,c,d):f(a,i,c,d)},error:function(a,b,f){if(br.isUnloading());else{g.ajaxRequest=null;var h=br.isEmpty(a.responseText)?a.statusText:a.responseText;e(h,i,c,d)}}})),this},this.requestInProgress=function(){return null!==this.ajaxRequest},this.abortRequest=function(){return null!==this.ajaxRequest&&this.ajaxRequest.abort(),this},this.invoke=function(b,c,d){var e={};return"function"==typeof c?d=c:e=c,g.events.triggerBefore(b,e),this.options.crossdomain&&(e.crossdomain="post"),a.ajax({type:this.options.crossdomain?"GET":"POST",data:e,dataType:this.options.crossdomain?"jsonp":"json",url:this.options.restServiceUrl+b+(this.options.authToken?"?token="+this.options.authToken:""),success:function(a){g.options.crossdomain&&"string"==typeof a?(g.events.trigger("error",b,a),g.events.triggerAfter(b,!1,a,e),"function"==typeof d&&d.call(g,!1,a,e)):(g.events.trigger(b,a,c),g.events.triggerAfter(b,!0,a,e),"function"==typeof d&&d.call(g,!0,a,e))},error:function(a,c,f){if(br.isUnloading());else{var h=br.isEmpty(a.responseText)?a.statusText:a.responseText;g.events.trigger("error",b,h),g.events.triggerAfter(b,!1,h,e),"function"==typeof d&&d.call(g,!1,h,e)}}}),this},this.fillCombo=function(b,c,d){d=d||{};var e=d.valueField||"rowid",f=d.nameField||"name",g=d.hideEmptyValue||!1,h=d.emptyValue||"--any--",i=d.selectedValue||null,j=d.selectedValueField||null;a(b).each(function(){var b=a(this).val();br.isEmpty(b)&&(b=a(this).attr("data-value"),a(this).removeAttr("data-value")),a(this).html("");var d="";g||(d=d+'<option value="">'+h+"</option>");for(var k in c)!i&&j&&"1"==c[k][j]&&(i=c[k][e]),d=d+'<option value="'+c[k][e]+'">'+c[k][f]+"</option>";a(this).html(d),br.isEmpty(i)||(b=i),br.isEmpty(b)||a(this).find("option[value="+b+"]").attr("selected","selected")})};var h;this.deferredSelect=function(a,c,d){d=d||this.options.refreshDelay;var e={};for(var f in a)e[f]=a[f];b.clearTimeout(h),h=b.setTimeout(function(){g.select(e,c)},d)}}b.br=b.br||{},b.br.dataSource=function(a,b){return new c(a,b)}}(jQuery,window),function(a,b){function c(b,c,d,e){function f(){g.isEmpty()&&(g.events.triggerBefore("nodata"),a(g.selector).html(g.options.templates.noData),g.events.trigger("nodata"),g.events.triggerAfter("nodata"))}var g=this;this.selector=b,this.options=e||{},this.options.templates=this.options.templates||{},this.options.templates.row=a(c).html(),this.options.templates.groupRow=this.options.templates.groupRow?a(this.options.templates.groupRow).html():"",this.options.templates.header=this.options.templates.header?a(this.options.templates.header).html():"",this.options.templates.footer=this.options.templates.footer?a(this.options.templates.footer).html():"",this.options.templates.noData=this.options.templates.noData?a(this.options.templates.noData).html():"",this.options.dataSource=d,this.options.selectors=this.options.selectors||{},this.options.selectors.header=this.options.selectors.header||this.options.headersSelector||this.selector,this.options.selectors.footer=this.options.selectors.footer||this.options.footersSelector||this.selector,this.options.selectors.remove=this.options.selectors.remove||this.options.deleteSelector||".action-delete",this.dataSource=this.options.dataSource,this.storageTag=this.options.storageTag?this.options.storageTag:document.location.pathname+":"+this.dataSource.options.restServiceUrl,this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)};var h=!1;g.loadingMoreData=!1,this.after("insert",function(a){g.events.trigger("change",a,"insert"),g.events.triggerAfter("change",a,"insert")}),this.after("update",function(a){g.events.trigger("change",a,"update"),g.events.triggerAfter("change",a,"update")}),this.after("remove",function(a){g.events.trigger("change",a,"remove"),g.events.triggerAfter("change",a,"remove")});var i=!1;return this.setStored=function(a,b){br.storage.set(this.storageTag+"stored:"+a,b)},this.getStored=function(a,b){return br.storage.get(this.storageTag+"stored:"+a,b)},this.disconnectFromDataSource=function(){i=!0},this.reconnectWithDataSource=function(){i=!1},this.renderHeader=function(b){return b=g.events.trigger("renderHeader",b)||b,a(br.fetch(g.options.templates.header,b))},this.renderFooter=function(b){return b=g.events.trigger("renderFooter",b)||b,a(br.fetch(g.options.templates.footer,b))},this.renderRow=function(b){b=g.events.trigger("renderRow",b)||b;var c=a(br.fetch(g.options.templates.row,b));return c.data("data-row",b),c},this.renderGroupRow=function(b){b=g.events.trigger("renderGroupRow",b)||b;var c=a(br.fetch(g.options.templates.groupRow,b));return c.data("data-row",b),c},this.prepend=function(b){return a(g.selector).prepend(b)},this.append=function(b){return a(g.selector).append(b)},this.insertDataRowAfter=function(b,c){var d=g.renderRow(b);return a(d).insertAfter(c),d},this.addDataRow=function(a){var b=g.renderRow(a);return g.events.triggerBefore("insert",a,b),g.events.trigger("insert",a,b),g.options.appendInInsert?g.append(b):g.prepend(b),g.events.triggerAfter("renderRow",a,b),g.events.triggerAfter("insert",a,b),b},this.hasRow=function(b){var c=a(g.selector).find("[data-rowid="+b+"]");return c.length>0},this.reloadRow=function(b,c,d){br.isEmpty(c)||br.isFunction(c)||(d=c,c=null),d=d||{},d.disableEvents=!0,g.dataSource.selectOne(b,function(b,e){b&&(g.refreshRow(e,d)||(g.isEmpty()&&a(g.selector).html(""),g.addDataRow(e)),"function"==typeof c&&c.call(g,e))},d)},this.removeRow=function(b){var c=a(g.selector).find("[data-rowid="+b+"]");c.length>0?(g.events.triggerBefore("remove",b),g.events.trigger("remove",b,c),c.remove(),f(),g.events.triggerAfter("remove",b,c)):g.dataSource.select()},this.refresh=function(a){g.dataSource.select(function(){a&&a()})},this.refreshRow=function(b,c){var d="[data-rowid="+b.rowid+"]";c&&c.refreshSelector&&(d=c.refreshSelector+d);var e=a(g.selector).find(d);if(e.length>0){var f=g.renderRow(b);g.events.triggerBefore("update",b);var h=a(e[0]);return g.events.trigger("update",b,h),h.replaceWith(f),h.data("data-row",b),g.events.triggerAfter("renderRow",b,f),g.events.triggerAfter("update",b,f),!0}return!1},this.getOrder=function(){var a=g.getOrderAndGroup(),b={};if(br.isArray(a))for(var c=0;c<a.length;c++)a[c].asc?b[a[c].fieldName]=1:b[a[c].fieldName]=-1;return b},this.setOrder=function(a){var b=[];for(var c in a)b.push({fieldName:c,asc:a[c]>0,group:!1,index:b.length});return a},this.setOrderAndGroup=function(a){return br.storage.set(this.storageTag+"orderAndGroup",a),a},this.getOrderAndGroup=function(){var a=br.storage.get(this.storageTag+"orderAndGroup",[]);return(br.isEmpty(a)||!br.isArray(a))&&(a=[]),a},this.isOrderConfigured=function(){var a=g.getOrderAndGroup();return br.isArray(a)&&a.length>0},this.loadMore=function(a){h||g.loadingMoreData||(g.loadingMoreData=!0,g.dataSource.select({},function(b,c){"function"==typeof a&&a.call(g,b,c),g.loadingMoreData=!1},{loadingMore:!0}))},this.isEmpty=function(){return 0===a(g.selector).find("[data-rowid]").length},this.getKeys=function(b){var c=[];return b||(b="data-rowid"),a("["+b+"]",a(g.selector)).each(function(){c.push(br.toInt(a(this).attr(b)))}),c},this.init=function(){function b(b){for(var c=0;c<b.length;c++){var d=a('.sortable[data-field="'+b[c].fieldName+'"].'+(b[c].asc?"order-asc":"order-desc"),a(g.options.selectors.header));d.addClass("icon-white").addClass("icon-border");var e=d.parent().find("div.br-sort-index");b.length>1&&(e.length>0?e.text(c+1):d.parent().append(a('<div class="br-sort-index">'+(c+1)+"</div>")))}}var c=g.getOrderAndGroup();br.isArray(c)&&0!==c.length||g.options.defaultOrderAndGroup&&g.setOrderAndGroup(g.options.defaultOrderAndGroup),b(g.getOrderAndGroup()),a(this.options.selectors.header).on("click",".sortable",function(c){var d=a(this).hasClass("icon-white")||a(this).hasClass("icon-border");c.metaKey||(a(".sortable",a(g.options.selectors.header)).removeClass("icon-white").removeClass("icon-border"),a(".br-sort-index",a(g.options.selectors.header)).remove()),d?a(this).removeClass("icon-white").removeClass("icon-border"):(a(this).siblings("i").removeClass("icon-white").removeClass("icon-border"),a(this).addClass("icon-white").addClass("icon-border"));var e,f=a(this).attr("data-field"),h={fieldName:f,asc:a(this).hasClass("order-asc"),group:a(this).hasClass("group-by")};if(c.metaKey||c.altKey||c.ctrlKey||c.shiftKey){e=g.getOrderAndGroup();for(var i=[],j=0;j<e.length;j++)e[j].fieldName!=f&&i.push(e[j]);e=i}else e=[];d||e.push(h),b(e),g.setOrderAndGroup(e),g.events.triggerBefore("changeOrder",e),g.dataSource.select()}),g.dataSource&&(g.dataSource.before("select",function(a,b){b.order=g.getOrder(),!g.loadingMoreData}),g.dataSource.after("select",function(b,c,d){a(g.selector).removeClass("progress-big"),b&&(h=0===c.length,i||g.render(c,g.loadingMoreData))}),g.dataSource.after("insert",function(b,c){b&&(g.isEmpty()&&a(g.selector).html(""),g.addDataRow(c))}),g.dataSource.on("update",function(a){g.refreshRow(a)||g.dataSource.select()}),g.dataSource.on("remove",function(a){g.removeRow(a)}),this.options.selectors.remove&&a(g.selector).on("click",this.options.selectors.remove,function(){var b=a(this).closest("[data-rowid]");if(b.length>0){var c=a(b).attr("data-rowid");br.isEmpty(c)||br.confirm("Delete confirmation","Are you sure you want to delete this record?",function(){g.dataSource.remove(c)})}}))},this.render=function(b,c){var d=a(g.selector);if(g.events.triggerBefore("change",b,"render"),b){var e,f,h;if(c||d.html(""),g.options.freeGrid){if(b=b[0],b.headers)for(e in b.headers)b.headers[e]&&a(g.options.selectors.header).append(g.renderHeader(b.headers[e]));if(b.footers)for(e in b.footers)b.footers[e]&&a(g.options.selectors.footer).append(g.renderFooter(b.headers[e]));if(a(g.options.selectors.header).html(""),a(g.options.selectors.footer).html(""),b.rows)if(0===b.rows.length)d.html(this.options.templates.noData);else for(e in b.rows)b.rows[e]&&(b.rows[e].row&&d.append(g.renderRow(b.rows[e].row)),b.rows[e].header&&a(g.options.selectors.header).append(g.renderHeader(b.rows[e].header)),b.rows[e].footer&&a(g.options.selectors.footer).append(g.renderFooter(b.rows[e].footer)));else d.html(this.options.templates.noData);
}else if(b&&b.length>0){var i,j=g.getOrderAndGroup(),k={},l="";for(e in b)if(b[e]){if(br.isArray(j)){for(h=0;h<j.length;h++)if(l=j[h].fieldName,j[h].group&&k[l]!=b[e][l]){for(f=h;f<j.length;f++)l=j[f].fieldName,k[l]=void 0;break}for(h=0;h<j.length;h++)if(l=j[h].fieldName,j[h].group&&k[l]!=b[e][l]){k[l]=b[e][l];var m=b[e];m.__groupBy={},m.__groupBy.__field=l,m.__groupBy.__value=b[e][l],m.__groupBy[l]=!0,d.append(g.renderGroupRow(m))}}i=g.renderRow(b[e]),d.append(i),g.events.triggerAfter("renderRow",b[e],i)}}else c||d.html(this.options.templates.noData)}else d.html(this.options.templates.noData);g.events.trigger("change",b,"render"),g.events.triggerAfter("change",b,"render")},this.init()}b.br=b.br||{},b.br.dataGrid=function(a,b,d,e){return new c(a,b,d,e)}}(jQuery,window),function(a,b){function c(c,d,e){function f(b){var c=k.storageTag;return c+=":filter-value",br.isEmpty(a(b).attr("id"))?br.isEmpty(a(b).attr("name"))||(c=c+":"+a(b).attr("name")):c=c+":"+a(b).attr("id"),br.isEmpty(a(b).attr("data-storage-key"))||(c=c+":"+a(b).attr("data-storage-key")),c}function g(){if(k.isValid()&&b.Select2&&!k.noDecoration&&!k.selector.attr("size")){var a={};k.options.skipTranslate&&(a.dropdownCssClass="skiptranslate"),k.options.allowClear&&(a.allowClear=k.options.allowClear,a.placeholder=k.options.emptyName),k.selector.select2(a)}}function h(a){return br.isFunction(k.options.onGetName)?k.options.onGetName.call(this,a):a[k.options.nameField]}function i(a){var b="";if(b+=!br.isEmpty(k.options.groupField)&&br.toInt(a[k.options.groupField])>0?"<optgroup":"<option",b=b+' value="'+a[k.options.valueField]+'"',!br.isEmpty(k.options.disabledField)&&br.toInt(a[k.options.disabledField])>0&&(b+=' disabled="disabled"'),b+=">",!br.isEmpty(k.options.levelField))for(var c=4*(br.toInt(a[k.options.levelField])-1),d=0;c>d;d++)b+="&nbsp;";return b+=h(a),b+=!br.isEmpty(k.options.groupField)&&br.toInt(a[k.options.groupField])>0?"</optgroup>":"</option>"}function j(b){l=b,k.saveSelection&&(k.saveToSessionStorage?k.options.selectedValue=br.session.get(f(k.selector)):k.options.selectedValue=br.storage.get(f(k.selector))),k.selector.each(function(){var c=a(this).val();br.isEmpty(c)&&(c=a(this).attr("data-value"),a(this).removeAttr("data-value")),a(this).html("");var d="",e={};e.data=b,k.options.hideEmptyValue||k.options.autoSelectSingle&&1==b.length||(e.s=d,k.events.triggerBefore("generateEmptyOption",e,a(this)),d=e.s,k.options.allowClear?d+="<option></option>":d=d+'<option value="'+k.options.emptyValue+'">'+k.options.emptyName+"</option>"),e.s=d,k.events.triggerBefore("generateOptions",e,a(this)),d=e.s;for(var f=0;f<b.length;f++)if(d+=i(b[f]),br.isEmpty(k.options.selectedValue)&&!br.isEmpty(k.options.selectedValueField)){var g=b[f][k.options.selectedValueField];(br.isBoolean(g)&&g||1==br.toInt(g))&&(k.options.selectedValue=b[f][k.options.valueField])}if(a(this).html(d),br.isEmpty(k.options.selectedValue)){if(!br.isEmpty(c))if(br.isArray(c))for(var h=0;h<c.length;h++)a(this).find("option[value="+c[h]+"]").attr("selected","selected");else a(this).find("option[value="+c+"]").attr("selected","selected")}else a(this).find("option[value="+k.options.selectedValue+"]").attr("selected","selected")}),g()}var k=this;this.selector=a(c),this.dataSource=d,this.options=e||{},this.options.valueField=this.options.valueField||"rowid",this.options.nameField=this.options.nameField||"name",this.options.levelField=this.options.levelField||null,this.options.selectedValue=this.options.selectedValue||null,this.options.skipTranslate=this.options.skipTranslate||null,this.options.selectedValueField=this.options.selectedValueField||null,this.options.hideEmptyValue=this.options.hideEmptyValue||"multiple"==this.selector.attr("multiple"),this.options.emptyName="undefined"==typeof this.options.emptyName?"--any--":this.options.emptyName,this.options.emptyValue="undefined"==typeof this.options.emptyValue?"":this.options.emptyValue,this.options.allowClear="undefined"==typeof this.options.allowClear?!1:this.options.allowClear,this.loaded=!1,this.options.skipTranslate&&this.selector.addClass("skiptranslate"),this.fields=this.options.fields||{},this.saveSelection=this.options.saveSelection||!1,this.saveToSessionStorage=this.options.saveToSessionStorage||!1,this.selectedValueField=this.options.selectedValueField||null,this.noDecoration=this.options.noDecoration,this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)},this.storageTag=this.options.storageTag?this.options.storageTag:document.location.pathname,this.dataSource&&(this.storageTag=this.storageTag+":"+this.dataSource.options.restServiceUrl),this.isValid=function(){return k.selector.length>0},this.isLoaded=function(){return k.loaded},this.hasOptions=function(){return k.selector.find("option").length>0},this.optionsAmount=function(){return k.selector.find("option").length},this.getFirstAvailableValue=function(){var b=null;return k.selector.find("option").each(function(){br.isEmpty(a(this).val())||br.isEmpty(b)&&(b=a(this).val())}),b};var l=[];this.selected=function(a){if(br.isArray(l)&&l.length>0){var b=this.val();if(!br.isEmpty(b))for(var c=0;c<l.length;c++)if(br.toInt(l[c][k.options.valueField])==br.toInt(b))return br.isEmpty(a)?l[c]:l[c][a]}},this.val=function(a){if(void 0!==a&&(k.saveSelection&&(k.saveToSessionStorage?br.session.set(f(k.selector),a):br.storage.set(f(k.selector),a)),k.isValid()&&(k.selector.val(a),g())),k.isValid()){var b=k.selector.val();return null!==b?b:void 0}},this.valOrNull=function(){if(k.isValid()){var a=this.val();return br.isEmpty(a)?null:a}},this.reset=function(a){br.storage.remove(f(this.selector)),br.session.remove(f(this.selector)),k.isValid()&&(this.selector.val(""),a?k.selector.trigger("change"):g())},this.selector.on("reset",function(){k.reset()}),k.load=k.reload=function(a,b){"function"==typeof a&&(b=a,a={}),k.dataSource&&(k.isValid()?k.dataSource.select(a,function(a,c){a&&(b&&b.call(k.selector,a,c),g(),k.loaded=!0)},{fields:k.fields}):(b&&b.call(k.selector,!0,[]),k.loaded=!0,k.events.trigger("load",[])))},k.dataSource?(k.dataSource.on("select",function(a){k.isValid()&&j(a),k.events.trigger("load",a)}),k.dataSource.after("insert",function(b,c){b&&k.isValid()&&(k.selector.append(a(i(c))),g()),k.events.trigger("change")}),k.dataSource.after("update",function(a,b){a&&k.isValid()&&b[k.options.valueField]&&(k.selector.find("option[value="+b[k.options.valueField]+"]").text(h(b)),g()),k.events.trigger("change")}),k.dataSource.after("remove",function(a,b){a&&k.isValid()&&b[k.options.valueField]&&(k.selector.find("option[value="+b[k.options.valueField]+"]").remove(),g()),k.events.trigger("change")})):(k.saveSelection&&(k.saveToSessionStorage?k.options.selectedValue=br.session.get(f(k.selector)):k.options.selectedValue=br.storage.get(f(k.selector)),br.isEmpty(k.options.selectedValue)||k.val(k.options.selectedValue)),g()),k.selector.change(function(){k.saveSelection&&(k.saveToSessionStorage?br.session.set(f(this),a(this).val()):br.storage.set(f(this),a(this).val())),k.events.trigger("change"),g()})}b.br=b.br||{},b.br.dataCombo=function(a,b,d){return new c(a,b,d)}}(jQuery,window),function(a,b){function c(b,c){var d=this;d.ctrl=a(b),br.isFunction(c)&&(c={onSave:c}),c=c||{},d.options=c,d.options.popover_placement=d.ctrl.attr("data-popover-placement")||"bottom",d.editor=null,d.savedWidth="",d.click=function(b,c){if(!d.activated()){var e="";e="undefined"!=typeof d.ctrl.attr("data-editable")?d.ctrl.attr("data-editable"):d.ctrl.text(),d.ctrl.data("brEditable-original-html",d.ctrl.html()),d.ctrl.data("brEditable-original-width",d.ctrl.css("width"));var f=d.ctrl.innerWidth();d.ctrl.innerHeight();d.ctrl.text(""),d.editor=a('<input type="text" />'),d.editor.addClass("form-control"),d.editor.css("width","100%"),d.editor.css("height","100%"),d.editor.css("min-height","30px"),d.editor.css("font-size",d.ctrl.css("font-size")),d.editor.css("font-weight",d.ctrl.css("font-weight")),d.editor.css("box-sizing","100%"),d.editor.css("-webkit-box-sizing","border-box"),d.editor.css("-moz-box-sizing","border-box"),d.editor.css("-ms-box-sizing","border-box"),d.editor.css("margin-top","2px"),d.editor.css("margin-bottom","2px"),d.ctrl.attr("data-editable-style")&&d.editor.attr("style",d.ctrl.attr("data-editable-style")),d.ctrl.append(d.editor),d.options.onGetContent&&(e=d.options.onGetContent.call(d.ctrl,d.editor,e)),d.editor.val(e),d.ctrl.css("width",f-10),d.editor.focus(),a("div.popover").remove(),d.options.hideHint||(d.options.saveOnLoosingFocus?d.editor.popover({placement:d.options.popover_placement,animation:!1,trigger:"manual",content:"WARNING!!! Changes will be saved after leaving input box, by pressing [Enter], or by pressing [Tab]. Press [Esc] to cancel changes."}):d.editor.popover({placement:d.options.popover_placement,animation:!1,trigger:"manual",content:"Press [Enter] to save changes, [Esc] to cancel changes."})),d.editor.popover("show"),d.options.saveOnLoosingFocus&&(a(d.editor).on("keydown",function(b){if(9==b.keyCode){var c=a(this).val();a("div.popover").remove(),d.options.onSave?d.options.onSave.call(d.ctrl,c,"keyup"):d.apply(c),b.stopPropagation(),b.preventDefault()}}),a(d.editor).on("blur",function(b){a("div.popover").remove();var c=a(this).val();d.options.onSave?d.options.onSave.call(d.ctrl,c,"blur"):d.apply(c)})),a(d.editor).on("keyup",function(b){var c=a(this).val();switch(b.keyCode){case 13:a("div.popover").remove(),d.options.onSave?d.options.onSave.call(d.ctrl,c,"keyup"):d.apply(c),b.stopPropagation();break;case 27:a("div.popover").remove(),d.cancel(),b.stopPropagation()}})}},d.activated=function(){return null!==d.editor},d.apply=function(b){a("div.popover").remove(),d.editor.remove(),d.editor=null,d.ctrl.html(b),"undefined"!=typeof d.ctrl.attr("data-editable")&&d.ctrl.attr("data-editable",b),d.ctrl.css("width","")},d.cancel=function(){a("div.popover").remove(),d.editor.remove(),d.editor=null,d.ctrl.html(d.ctrl.data("brEditable-original-html")),d.ctrl.css("width","")}}b.br=b.br||{},b.br.editable=function(b,d,e){if(0===a("#br_editablePopover").length&&a("body").append(a('<div id="br_editablePopover"></div>')),"string"==typeof d){var f=a(b).data("brEditable-editable");f||a(b).data("brEditable-editable",f=new c(a(b),d)),f&&f[d](e)}else a(document).on("click",b,function(b){var e=a(this),f=e.data("brEditable-editable");f||e.data("brEditable-editable",f=new c(this,d)),f.click(b)})}}(jQuery,window),function(a,b){function c(){var b=Math.round(100*j/i);a("#br_progressBar_Bar").css("width",b+"%"),a("#br_progressMessage").text(k),a("#br_progressStage").text(j+" of "+i)}function d(c){a(c).data("brAutoSizeConfigured")||!function(c){2==br.bootstrapVersion&&(c.css("top","20px"),c.css("margin-top","0px")),c.on("shown.bs.modal",function(){br.resizeModalPopup(c)}),a(b).resize(function(){br.resizeModalPopup(c)}),c.data("brAutoSizeConfigured",1)}(a(c))}function e(b){void 0!==a.ui&&a(b).each(function(){a(this).attr("data-format")?a(this).datepicker({dateFormat:a(this).attr("data-format")}):a(this).datepicker({})})}function f(b){try{a(b).each(function(){a(this).bootstrapDatepicker({todayBtn:"linked",clearBtn:!0,multidate:!1,autoclose:!0,todayHighlight:!0})})}catch(c){br.log("[ERROR] bootstrapDatepicker expected but script was not loaded")}}b.br=b.br||{},b.br.bootstrapVersion=0,b.br.showError=function(a){alert(a)},b.br.growlError=function(c,d){br.isEmpty(c)||("undefined"!=typeof a.gritter?a.gritter.add({title:br.trn("Error"),text:c,class_name:"gritter-red",image:d}):"undefined"!=typeof b.humane?humane.log(c,{addnCls:"humane-jackedup-error humane-original-error",timeout:5e3}):alert(c))},b.br.showMessage=function(a){br.isEmpty(a)||alert(a)},b.br.growlMessage=function(c,d,e){br.isEmpty(c)||("undefined"!=typeof a.gritter?(br.isEmpty(d)&&(d=" "),a.gritter.add({title:d,text:c,class_name:"gritter-light",image:e})):"undefined"!=typeof b.humane?humane.log(c):alert(c))},b.br.panic=function(b){throw a(".container").html('<div class="row"><div class="span12"><div class="alert alert-error"><h4>'+br.trn("Error")+"!</h4><p>"+b+"</p></div></div></div>"),""},b.br.confirm=function(b,c,d,e,f){"function"==typeof d&&(f=e,e=d,d=null),f=f||{},f.cancelTitle=f.cancelTitle||br.trn("Cancel");var g,h='<div class="modal modal-autosize';f.cssClass&&(h=h+" "+f.cssClass),h+='" id="br_modalConfirm"',2==br.bootstrapVersion&&(h+=' style="top:20px;margin-top:0px;"'),h+=">";var i="";if(f.checkBoxes)for(g in f.checkBoxes){var j=f.checkBoxes[g],k="";j["default"]&&(k="checked"),i=i+'<div class="checkbox"><label class="checkbox"><input type="checkbox" class="confirm-checkbox" name="'+j.name+'" value="1" '+k+"> "+j.title+"</label></div>"}if(h=h+'<div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h3 class="modal-title">'+b+'</h3></div><div class="modal-body" style="overflow-y:auto;">'+c+i+'</div><div class="modal-footer">',f.showDontAskMeAgain){var l=f.dontAskMeAgainTitle?f.dontAskMeAgainTitle:br.trn("Don't ask me again");h=h+'<label style="text-align:left;float:left;padding-top:5px;" class="checkbox"><input name="showDontAskMeAgain" type="checkbox" value="1"> '+l+"</label>"}if(br.isEmpty(d)){var m=f.yesTitle||br.trn("Yes");h=h+'<a href="javascript:;" class="btn btn-sm btn-primary action-confirm-close" rel="confirm">&nbsp;'+m+"&nbsp;</a>"}else for(g in d)h=h+'<a href="javascript:;" class="btn btn-sm btn-default action-confirm-close" rel="'+g+'">&nbsp;'+d[g]+"&nbsp;</a>";h=h+'<a href="javascript:;" class="btn btn-sm btn-default action-confirm-cancel">&nbsp;'+f.cancelTitle+"&nbsp;</a>",h+="</div></div></div></div>";var n=a(h),o=!0,p=function(b){f.onShow&&f.onShow.call(n),a(this).find(".action-confirm-close").click(function(){var b=a(this).attr("rel"),c=a("input[name=showDontAskMeAgain]",a(n)).is(":checked"),d={};a("input.confirm-checkbox").each(function(){d[a(this).attr("name")]=a(this).is(":checked")}),o=!1,n.modal("hide"),e(b,c,d),n.remove()}),a(this).find(".action-confirm-cancel").click(function(){var b="cancel",c=a("input[name=showDontAskMeAgain]",a(n)).is(":checked");o=!1,n.modal("hide"),f.onCancel&&f.onCancel(b,c),n.remove()})},q=function(a){f.onHide&&f.onHide.call(this),o&&n.remove()};a(n).on("show.bs.modal",p),a(n).on("hide.bs.modal",q),a(n).modal("show"),br.enchanceBootstrap(n),br.resizeModalPopup(n)},b.br.error=function(b,c,d){var e='<div class="modal modal-autosize" id="br_modalError"';2==br.bootstrapVersion&&(e+=' style="top:20px;margin-top:0px;"'),e+='><div class="modal-dialog"><div class="modal-content">',""!==b&&(e=e+'<div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3 class="modal-title">'+b+"</h3></div>"),e=e+'<div class="modal-body" style="overflow-y:auto;">'+c+'</div><div class="modal-footer" style="background-color:red;"><a href="javascript:;" class="btn btn-sm btn-default" data-dismiss="modal">&nbsp;'+br.trn("Dismiss")+"&nbsp;</a></div></div></div></div>";var f=a(e),g=function(a){d&&d.call(this),f.remove()};a(f).on("hide.bs.modal",g),a(f).modal("show"),br.enchanceBootstrap(f),br.resizeModalPopup(f)},b.br.inform=function(b,c,d,e){d&&"function"!=typeof d&&(e=d,d=null),e=e||{};var f=e.buttonTitle||"Dismiss",g='<div class="modal modal-autosize" id="br_modalInform"';if(2==br.bootstrapVersion&&(g+=' style="top:20px;margin-top:0px;"'),g+='><div class="modal-dialog"><div class="modal-content">',""!==b&&(g=g+'<div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3 class="modal-title">'+b+"</h3></div>"),g=g+'<div class="modal-body" style="overflow-y:auto;">'+c+'</div><div class="modal-footer">',e.showDontAskMeAgain){var h=e.dontAskMeAgainTitle?e.dontAskMeAgainTitle:br.trn("Don't ask me again");g=g+'<label style="text-align:left;float:left;padding-top:5px;" class="checkbox"><input name="showDontAskMeAgain" type="checkbox" value="1"> '+h+"</label>"}g=g+'<a href="javascript:;" class="btn btn-sm btn-default" data-dismiss="modal">&nbsp;'+br.trn(f)+"&nbsp;</a></div></div></div></div>";var i=a(g),j=function(b){var c=a("input[name=showDontAskMeAgain]",a(i)).is(":checked");d&&d.call(this,c),i.remove()};a(i).on("hide.bs.modal",j),a(i).modal("show"),br.enchanceBootstrap(i),br.resizeModalPopup(i)},b.br.prompt=function(b,c,d,e){e=e||{};var f={};br.isObject(c)?f=c:(e.valueRequired=!0,f[c]="");var g='<div class="modal modal-autosize" id="br_modalPrompt"';2==br.bootstrapVersion&&(g+=' style="top:20px;margin-top:0px;"'),g=g+'><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3>'+b+'</h3></div><div class="modal-body" style="overflow-y:auto;">';for(var h in f)g=br.isObject(f[h])?g+"<label>"+h+'</label><input type="text" '+(f[h].id?'id="'+f[h].id+'"':"")+' class="span4 '+(br.isEmpty(f[h]["class"])?"":f[h]["class"])+'" value="'+f[h].value+'" data-click-on-enter="#br_modalPrompt .action-confirm-close" />':g+"<label>"+h+'</label><input type="text" class="form-control '+("int"==e.valueType?" input-small":" justified")+(e.valueRequired?" required":"")+' " value="'+f[h]+'" data-click-on-enter="#br_modalPrompt .action-confirm-close" />';g+='</div><div class="modal-footer">',g+='<a href="javascript:;" class="btn btn-sm btn-primary action-confirm-close" rel="confirm" >Ok</a>',g=g+'<a href="javascript:;" class="btn btn-sm btn-default" data-dismiss="modal">&nbsp;'+br.trn("Cancel")+"&nbsp;</a>",g+="</div></div></div></div>";var i=a(g),j=!0;a(i).on("shown.bs.modal",function(b){a(this).find("input[type=text]")[0].focus()}).on("show.bs.modal",function(b){a(this).find(".action-confirm-close").click(function(){var b,c=[],f=!0,g=[];if(a(this).closest("div.modal").find("input[type=text]").each(function(){a(this).hasClass("required")&&br.isEmpty(a(this).val())&&(f=!1,b=a(this)),c.push(a(this).val().trim()),g.push(a(this))}),f){if(e.onValidate)try{e.onValidate.call(this,c)}catch(h){f=!1,br.growlError(h),1==g.length&&g[0].focus()}f&&(j=!1,a(i).modal("hide"),d.call(this,c),i.remove())}else br.growlError("Please enter value"),b[0].focus()})});var k=function(a){e.onHide?e.onHide.call(this):e.onhide&&e.onhide.call(this),j&&i.remove()};a(i).on("hide.bs.modal",k),a(i).modal("show"),br.enchanceBootstrap(i),br.resizeModalPopup(i)};var g=!1;b.br.fetch=function(a,c,d){if(c=c||{},!a)return"";if("undefined"!=typeof b.Mustache)return Mustache.render(a,c);if("undefined"!=typeof b.Handlebars){var e=Handlebars.compile(a);return e(c)}g||(g=!0,this.showError("Template engine not found. Please link bright/3rdparty/mustache.js or bright/3rdparty/handlebars.js."))};var h=0;b.br.isAJAXInProgress=function(){return h>0},b.br.showAJAXProgress=function(){h++,a(".ajax-in-progress").css("visibility","visible")},b.br.hideAJAXProgress=function(){h--,0>=h&&(a(".ajax-in-progress").css("visibility","hidden"),h=0)},b.br.jsonEncode=function(a){return JSON.stringify(a)},b.br.jsonDecode=function(a){try{return JSON.parse(a)}catch(b){return null}};var i=0,j=0,k="",l='<div id="br_progressBar" class="modal" style="display:none;z-index:10000;top:20px;margin-top:0px;" data-backdrop="static">  <div class="modal-dialog">    <div class="modal-content">      <div class="modal-body">        <table style="width:100%;font-size:18px;font-weight:300;margin-bottom:10px;">          <tr>            <td id="br_progressMessage"></td>            <td align="right" id="br_progressStage" style="font-size:14px;font-weight:300;"></td>          </tr>        </table>        <div id="br_progressBar_Section" style="display:none;clear:both;">          <div style="margin-bottom:0px;padding:0px;height:20px;overflow: hidden;background-color: #f5f5f5;border-radius: 4px;box-shadow: inset 0 1px 2px rgba(0,0,0,.1);">            <div id="br_progressBar_Bar" style="background-color:#008cba;border:none;padding:0px;height:20px;"></div>          </div>        </div>        <div id="br_progressBarAnimation" style="display1:none;padding-top:10px;">          <center><img src="'+br.baseUrl+'bright/images/progress-h.gif" /></center>        </div>      </div>    </div>  </div></div>';b.br.startProgress=function(b,d){if(br.isNumber(b)||(d=b,b=0),i=b,j=0,k=d,0===a("#br_progressBar").length){var e=a(l);2==br.bootstrapVersion&&(e.css("top","20px"),e.css("margin-top","0px")),a("body").append(e)}i>1?(a("#br_progressBar_Section").show(),a("#br_progressStage").show()):(a("#br_progressBar_Section").hide(),a("#br_progressStage").hide()),a("#br_progressBar").modal("show"),c()},b.br.showProgress=function(){a("#br_progressBar").modal("show")},b.br.hideProgress=function(){a("#br_progressBar").modal("hide")},b.br.incProgress=function(a){a||(a=1),i+=a,c()},b.br.setProgress=function(a,b){j=a,br.isEmpty(b)||(k=b),c()},b.br.stepProgress=function(a,b){br.isNumber(a)?j+=a:(j++,b=a),br.isEmpty(b)||(k=b),c()},b.br.initScrollableAreas=function(c){a(".br-scrollable").each(function(){function d(){var d=0;0!==f.length&&(d=f.height()),c&&(d=0);var h=a(b).height()-d-g;if(h>0){var i=0;i=f.length>0?"static"==f.css("position")?g:d+g:g,e.css("margin-top",i+"px"),e.css("height",h+"px")}}var e=a(this).parent(".br-container"),f=a("nav.navbar");0===f.length&&(f=a("div.navbar"));var g=0;"static"!=f.css("position")&&(g=e.offset().top),c&&(g=0),a("body").css("overflow","hidden"),a(b).on("resize",function(){d()}),d()})},b.br.resizeModalPopup=function(c){var d=a(b).height()-a(c).find(".modal-header").outerHeight()-a(c).find(".modal-footer").outerHeight()-90;a(c).find(".modal-body").css("max-height",d+"px"),a(c).find(".modal-body").css("overflow-y","auto")},b.br.enchanceBootstrap=function(b){b?a(b).hasClass("modal-autosize")&&d(a(b)):a("div.modal.modal-autosize").each(function(){d(a(this))}),void 0!==a.ui&&(b?a(b).not(".ui-draggable").each(function(){a(this).find(".modal-header").length>0&&a(this).draggable({handle:".modal-header",cursor:"pointer"}).find(".modal-header").css("cursor","move")}):a(".modal").not(".ui-draggable").each(function(){a(this).find(".modal-header").length>0&&a(this).draggable({handle:".modal-header",cursor:"pointer"}).find(".modal-header").css("cursor","move")}))},b.br.attachDatePickers=function(b){b?(e(a("input.datepicker",b)),f(a("input.bootstrap-datepicker",b))):(e(a("input.datepicker")),f(a("input.bootstrap-datepicker")))},a(document).ready(function(){var b=!1;if(a.fn.modal?-1==a.fn.modal.toString().indexOf("bs.modal")?br.bootstrapVersion=2:br.bootstrapVersion=3:br.bootstrapVersion=0,a(document).ajaxStart(function(){br.showAJAXProgress()}),a(document).ajaxStop(function(){br.hideAJAXProgress()}),a(document).ajaxError(function(a,c,d,e){401==c.status&&(b||(b=!0,br.growlError(br.trn("You are trying to run operation which require authorization."))))}),a(document).on("keypress","input[data-click-on-enter]",function(b){13==b.keyCode&&a(a(this).attr("data-click-on-enter")).trigger("click")}),br.enchanceBootstrap(),br.attachDatePickers(),a(".focused").length>0)try{a(".focused")[0].focus()}catch(c){}if(!br.isTouchScreen){var d=a("body").attr("data-disable-bounce-container");br.isEmpty(d)||br.disableBounce(a(d))}br.initScrollableAreas(),2==br.bootstrapVersion&&a("ul.dropdown-menu [data-toggle=dropdown]").on("touchstart",function(b){b.preventDefault(),b.stopPropagation(),a(this).closest(".dropdown-menu").find(".dropdown-submenu").removeClass("open"),a(this).parent().addClass("open")})})}(jQuery,window),function(a,b){b.br=b.br||{};var c=[];a(document).ready(function(){a("body").on("paste",function(a){function b(a,b){var d=new FileReader;d.onload=function(b){var d=/^data[:](.+?)\/(.+?);/.exec(b.target.result),e="other",f="binary";d&&(e=d[1],f=d[2]),a.dataType=e,a.dataSubType=f,a.dataValue=b.target.result,a.data[e]=a.data[e]||{},a.data[e][f]=b.target.result;for(var g=0;g<c.length;g++)c[g].call(b,a)},d.readAsDataURL(b)}function d(a,b,c,d){var e=b.getData(c);if(e&&e.length>0){d&&(c="image/url");var f=/^(.+?)\/(.+?)$/.exec(c),g="other",h="binary";return f&&(g=f[1],h=f[2]),a.dataType=g,a.dataSubType=h,a.dataValue=e,d&&(a.data[g]=a.data[g]||{},a.data[g][h]=e),!0}return!1}var e={data:{},dataType:"",dataSubType:"",dataValue:""};if(a=a.originalEvent,a.clipboardData){var f;for(f=0;f<a.clipboardData.types.length;f++){var g=a.clipboardData.types[f],h=/^(.+?)\/(.+?)$/.exec(g),i="other",j=g;h&&(i=h[1],j=h[2]),e.data[i]=e.data[i]||{},e.data[i][j]=a.clipboardData.getData(g)}var k=!0;if(d(e,a.clipboardData,"public.url",!0));else if(d(e,a.clipboardData,"text/html"))e.dataValue=e.dataValue.replace(/<(html|body|head|meta|link)[^>]*?>/g,"").replace(/<\/(html|body|head|meta|link)[^>]*?>/g,"");else if(d(e,a.clipboardData,"text/plain"));else{if(a.clipboardData.items&&a.clipboardData.items.length>0)for(f=0;f<a.clipboardData.items.length;f++)a.clipboardData.items[f].type.match("image.*")&&(k=!1,b(e,a.clipboardData.items[f].getAsFile()));if(a.clipboardData.files&&a.clipboardData.files.length>0)for(f=0;f<a.clipboardData.files.length;f++)a.clipboardData.files[f].type.match("image.*")&&(k=!1,b(e,a.clipboardData.files[0]))}if(k)for(f in c)c[f].call(a,e)}})}),b.br.onPaste=function(a){c.push(a)}}(jQuery,window),function(a){function b(a){function b(){for(var a in d){var b=d[a];"added"==b.status&&(b.status="inprogress",f.emit("RMQ/Subscribe",{uid:b.uid,exchange:b.exchange,topic:b.topic}))}}var c=this,d=[],e=1;a=a||{},a.host=a.host||"localhost",a.port=a.port||80,this.events=br.eventQueue(this),this.before=function(a,b){this.events.before(a,b)},this.on=function(a,b){this.events.on(a,b)},this.after=function(a,b){this.events.after(a,b)};var f=io.connect(a.host+":"+a.port,{secure:!0});return f.on("connect",function(){c.events.trigger("rmq.log","connected"),c.events.trigger("rmq.connect"),b()}),f.on("disconnect",function(){c.events.trigger("rmq.log","disconnected"),c.events.trigger("rmq.disconnect");for(var a in d)d[a].status="added"}),f.on("error",function(a){c.events.trigger("rmq.log",a),c.events.trigger("rmq.error",a)}),f.on("RMQ/Message",function(a){c.events.trigger("rmq.log",a),c.events.trigger("rmq.message",a),d[a.uid]&&d[a.uid].active&&d[a.uid].callback.call(this,a.data)}),f.on("RMQ/Subscribed",function(a){c.events.trigger("rmq.log","subscribed",a),c.events.trigger("rmq.subscribed",a),d[a.uid]&&(d[a.uid].active=!0)}),this.subscribe=function(a,c,f){var g={uid:e++,exchange:a,topic:c,callback:f,status:"added"};d[g.uid]=g,b()},this.sendMessage=function(a,b,c){f.emit("RMQ/SendMessage",{exchange:a,data:b,topic:c})},this.getSocket=function(){return f},this}var c;a.br=a.br||{},a.br.rabbitMQ=function(a){return c||(c=new b(a)),c}}(window);