/* jshint ignore:start */

(function(e){e.gritter={};e.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1e3,time:6e3};e.gritter.add=function(e){try{return t.add(e||{})}catch(e){}};e.gritter.remove=function(e,i){t.removeSpecific(e,i||{})};e.gritter.removeAll=function(e){t.stop(e||{})};var t={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<a class="gritter-close"href="#" tabindex="1">hide</a>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none" role="alert"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(i){if(typeof i=="string"){i={text:i}}if(i.text===null){throw'You must supply "text" parameter.'}if(!this._is_setup){this._runSetup()}var r=i.title,s=i.text,n=i.image||"",o=i.sticky||false,a=i.class_name||e.gritter.options.class_name,_=e.gritter.options.position,c=i.time||"";this._verifyWrapper();this._item_count++;var f=this._item_count,p=this._tpl_item;e(["before_open","after_open","before_close","after_close"]).each(function(r,s){t["_"+s+"_"+f]=e.isFunction(i[s])?i[s]:function(){}});this._custom_timer=0;if(c){this._custom_timer=c}var l=n!=""?'<img src="'+n+'" class="gritter-image" />':"",u=n!=""?"gritter-with-image":"gritter-without-image";if(r){r=this._str_replace("[[title]]",r,this._tpl_title)}else{r=""}p=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[r,s,this._tpl_close,l,this._item_count,u,a],p);if(this["_before_open_"+f]()===false){return false}e("#gritter-notice-wrapper").addClass(_).append(p);var m=e("#gritter-item-"+this._item_count);m.fadeIn(this.fade_in_speed,function(){t["_after_open_"+f](e(this))});if(!o){this._setFadeTimer(m,f)}e(m).bind("mouseenter mouseleave",function(i){if(i.type=="mouseenter"){if(!o){t._restoreItemIfFading(e(this),f)}}else{if(!o){t._setFadeTimer(e(this),f)}}t._hoverState(e(this),i.type)});e(m).find(".gritter-close").click(function(){t.removeSpecific(f,{},null,true);return false});return f},_countRemoveWrapper:function(t,i,r){i.remove();this["_after_close_"+t](i,r);if(e(".gritter-item-wrapper").length==0){e("#gritter-notice-wrapper").remove()}},_fade:function(e,i,r,s){r=r||{};var n=typeof r.fade!="undefined"?r.fade:true,o=r.speed||this.fade_out_speed,a=s;this["_before_close_"+i](e,a);if(s){e.unbind("mouseenter mouseleave")}if(n){e.animate({opacity:0},o,function(){e.animate({height:0},300,function(){t._countRemoveWrapper(i,e,a)})})}else{this._countRemoveWrapper(i,e)}},_hoverState:function(e,t){if(t=="mouseenter"){e.addClass("hover");e.find(".gritter-close").show()}else{e.removeClass("hover");e.find(".gritter-close").hide()}},removeSpecific:function(t,i,r,s){if(!r){r=e("#gritter-item-"+t)}this._fade(r,t,i||{},s)},_restoreItemIfFading:function(e,t){window.clearTimeout(this["_int_id_"+t]);e.stop().css({opacity:"",height:""})},_runSetup:function(){for(var t in e.gritter.options){this[t]=e.gritter.options[t]}this._is_setup=1},_setFadeTimer:function(e,i){var r=this._custom_timer?this._custom_timer:this.time;this["_int_id_"+i]=window.setTimeout(function(){t._fade(e,i)},r)},stop:function(t){var i=e.isFunction(t.before_close)?t.before_close:function(){};var r=e.isFunction(t.after_close)?t.after_close:function(){};var s=e("#gritter-notice-wrapper");i(s);s.fadeOut(function(){e(this).remove();r()})},_str_replace:function(e,t,i,r){var s=0,n=0,o="",a="",_=0,c=0,f=[].concat(e),p=[].concat(t),l=i,u=p instanceof Array,m=l instanceof Array;l=[].concat(l);if(r){this.window[r]=0}for(s=0,_=l.length;s<_;s++){if(l[s]===""){continue}for(n=0,c=f.length;n<c;n++){o=l[s]+"";a=u?p[n]!==undefined?p[n]:"":p[0];l[s]=o.split(f[n]).join(a);if(r&&l[s]!==o){this.window[r]+=(o.length-l[s].length)/f[n].length}}}return m?l:l[0]},_verifyWrapper:function(){if(e("#gritter-notice-wrapper").length==0){e("body").append(this._tpl_wrap)}}}})(jQuery);